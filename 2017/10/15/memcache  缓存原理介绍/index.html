<!DOCTYPE html><html lang="null"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>memcache  缓存原理介绍 | Hexo</title><link rel="stylesheet" type="text/css" href="//fonts.neworld.org/css?family=Source+Code+Pro"><link rel="stylesheet" type="text/css" href="/css/style.css?v=2.0.1"><link rel="stylesheet" type="text/css" href="/css/highlight.css?v=2.0.1"><link rel="Shortcut Icon" href="/favicon.ico"><link rel="bookmark" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">memcache  缓存原理介绍</h1><a id="logo" href="/.">Hexo</a><p class="description"></p></div><div id="nav-menu"><a href="/." class="current"><i class="fa fa-home"> Start</i></a><a href="/archives/"><i class="fa fa-archive"> Archiv</i></a><a href="/about/"><i class="fa fa-user"> Über</i></a><a href="/atom.xml"><i class="fa fa-rss"> RSS</i></a></div><div id="search-form"><div id="result-mask" class="hide"></div><label><input id="search-key" type="text" autocomplete="off" placeholder="Arama"></label><div id="result-wrap" class="hide"><div id="search-result"></div></div><div class="hide"><template id="search-tpl"><div class="item"><a href="/{path}" title="{title}"><div class="title">{title}</div><div class="time">{date}</div><div class="tags">{tags}</div></a></div></template></div></div></div><div id="layout" class="layout-g"><div class="layout-l"><div class="content_container"><div class="post"><h1 class="post-title">memcache  缓存原理介绍</h1><div class="post-meta"><a href="/2017/10/15/memcache  缓存原理介绍/#comments" class="comment-count"></a><p><span class="date">Oct 15, 2017</span><span><i id="busuanzi_container_page_pv"><i id="busuanzi_value_page_pv"></i><i>Schlägt</i></i></span></p></div><div class="post-content"><h2 id="memcached-是什么？"><a href="#memcached-是什么？" class="headerlink" title="memcached 是什么？"></a>memcached 是什么？</h2><p> memcached 是以 LiveJournal 旗下 Danga Interactive 公司的 Brad Fitzpatric 为首开发的一款软件。现在<br>已成为 mixi、hatena、Facebook、Vox、LiveJournal 等众多服务中提高 Web 应用扩展性的重要因素。许多 Web 应用都将数据保存到 RDBMS 中，应用服务器从中读取数据并在浏览器中显示。但随着数<br>据量的增大、访问的集中，就会出现 RDBMS 的负担加重、数据库响应恶恶化、网站显示延迟等重大<br>影响。<br>这时就该 memcached 大显身手了。memcached 是高性能的分布式内存缓存服务器。一般的使用目的<br>是，通过缓存数据库查询结果，减少数据库访问次数，以提高动态 Web 应用的速度、提高可扩展<br>性。  </p>
<a id="more"></a>
<h3 id="memcached-的特征"><a href="#memcached-的特征" class="headerlink" title="memcached 的特征"></a>memcached 的特征</h3><p>  memcached 作为高速运行的分布式缓存服务器，具有以下的特点。<br>    协议简单；<br>    基于 libevent 的事件处理<br>    内置内存存储方式<br>    memcached 不互相通信的分布式  </p>
<p>协议简单<br>memcached 的服务器客户端通信并不使用复杂的 XML   等格式，而使用简单的基于文本行的协议。<br>因此，通过 telnet 也能在 memcached 上保存数据，取得数据。  </p>
<p>  基于 libevent 的事件处理<br>libevent 是个程序库，它将 Linux 的 epoll、BSD 类操作系统的   kqueue 等事件处理功能封装成统一的<br>接口。即使对服务器的连接数增加，也能发挥 O(1)的性能。memcached 使用这个 libevent 库，因此<br>能在 Linux、BSD、Solaris 等操作系统上发挥其高性能   。关于事件处理这里就不再详细介绍，可以<br>参考 Dan Kegel 的 The C10K Problem。  </p>
<p>内置内存存储方式<br>为了提高性能，memcached 中保存的数据都存储在 memcached 内置的内存存储空间中。由于数据仅<br>存在于内存中，因此重启 memcached、重启操作系统会导致全部数据消失。另外，内容容量达到指<br>定值之后，就基于 LRU(Least Recently Used)算法自动删除不使用的缓存。memcached 本身是为缓存<br>而设计的服务器，因此并没有过多考虑数据的永久性问题。关于内存存储的详细信息，请参考本文<br>的 第 2 章以后前坂介绍的内容。  </p>
<p>memcached 不互相通信的分布式<br>memcached 尽管是“分布式”缓存服务器，但服务器端并没有分布式功能。各个 memcached 不会互<br>相通信以共享信息。那么，怎样进行分布式呢？这完全取决于客户端的实现。本文也将介绍<br>memcached 的分布式。  </p>
<p>memcached 现在已经被收入到 base 仓库，直接使用 rpm 安装即可。  </p>
<p>memcached 选项：<br>    -p  指定端口<br>    -f  指定 chuank 大小的倍数，步径的长度<br>    -u  指明运行时的用户身份<br>    -m  指定缓存空间大小<br>    -c  最大并发连接数<br>    -M  内存耗尽时，不执行LRU清理缓存，而是拒绝存入新的缓存项，直到有多余的空间可用时为止。<br>    -t  启动的用于响应用户请求的线程数  </p>
<p>memcached 默认是没有认证功能的，可借用于 SASL进行认证。  </p>
<p>使用 memcached 一般要调用客户端工具库 ，工具可有很多种，如果是 C C++ 语言的用libmemcached 这个库 ，如果是 PHP 语言的用 php-pecl-memcache   php-pecl-memcached 这两个库，用 python 语言要用 python-memcached 这个库， 所以一般在安装 memcached 时一定也要把 libmemcached 也装上。  </p>
<p>要想在 tomcat 中使用 mencached ，必须在 tomcat 中添加 安装（memcached 的资源管理器），这个资源管理器是由 java 语言开发的，使用这个资源管理器要从官网上下载一些安装包，这些包就下载到 tomcat 的 /usr/share/java/tomcat/ 这个目录下.<br>    需用安装包的列表：<br>        memcached-session-manager-2.3.0.jar<br>        memcached-session-manager-tc7-2.3.0.jar<br>        spymemcached-2.12.3.jar<br>        asm-6.2.jar<br>        kryo-4.0.2.jar<br>        kryo-serializers-0.42.jar<br>        minlog-1.3.0.jar<br>        msm-kryo-serializer-2.3.0.jar<br>        objenesis-2.6.jar<br>        reflectasm-1.11.7.jar<br>要想找这些包可以在 github 上搜索   </p>
<p>要想配置tomcat 支持使用这些资源文件，就要把 tomcat 配置文件中的会话管理器给换掉。<br>     先在 tomcat 服务节点上安装 memcached<br>        yum install memcached  libmemcached  </p>
<pre><code>然后修改 tomcat 配置文件  vim server.xml
在里面的 &lt;Context&gt; 语句块中添加 (&lt;Context&gt; 语句块在 &lt;Host&gt;语句块中)  ：
&lt;Context path=&quot;/&quot; docBase=&quot;ROOT&quot; reloadable=&quot;&quot;&gt;    
    &lt;Manager className=&quot;de.javakaffee.web.msm.MemcachedBackupSessionManager&quot;
         memcachedNodes=&quot;n1:li.01.com:11211,n2:li.02.com:11211&quot;
         failoverNodes=&quot;n2&quot;
         requestUriIgnorePattern=&quot;.*\.(ico|png|gif|jpg|css|js)$&quot;
         transcoderFactoryClass=&quot;de.javakaffee.web.msm.serializer.kryo.KryoTranscoderFactory&quot;
    /&gt;
&lt;/Context&gt;  

添加完后重启 tomcat 服务  

这样在前端调度就可以进行会话绑定了，这就实现了 session server 会话绑定。  
</code></pre></div><div class="tags"><a href="/tags/Linux/">Linux</a><a href="/tags/memcache/">memcache</a></div><div class="post-share"><div class="bdsharebuttonbox"><span style="float:left;line-height: 28px;height: 28px;font-size:16px;font-weight:blod">分享到：</span><a href="#" data-cmd="more" class="bds_more"></a><a href="#" data-cmd="mshare" title="分享到一键分享" class="bds_mshare"></a><a href="#" data-cmd="fbook" title="分享到Facebook" class="bds_fbook"></a><a href="#" data-cmd="twi" title="分享到Twitter" class="bds_twi"></a><a href="#" data-cmd="linkedin" title="分享到linkedin" class="bds_linkedin"></a><a href="#" data-cmd="youdao" title="分享到有道云笔记" class="bds_youdao"></a><a href="#" data-cmd="evernotecn" title="分享到印象笔记" class="bds_evernotecn"></a><a href="#" data-cmd="weixin" title="分享到微信" class="bds_weixin"></a><a href="#" data-cmd="qzone" title="分享到QQ空间" class="bds_qzone"></a><a href="#" data-cmd="tsina" title="分享到新浪微博" class="bds_tsina"></a></div></div><div class="post-nav"><a href="/2018/08/09/Linux 防火墙各种规则实战应用/" class="pre"></a><a href="/2017/10/08/tomcat 各种架构实验演示/" class="next">tomcat 各种架构实验演示</a></div><div id="comments"></div></div></div></div><div class="layout-r"><div id="sidebar"><div class="search-pla"></div><div id="toc" class="widget"><div class="widget-title"><i class="fa fa-fei">Inhalte</i></div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#memcached-是什么？"><span class="toc-text">memcached 是什么？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#memcached-的特征"><span class="toc-text">memcached 的特征</span></a></li></ol></li></ol></div><div class="widget"><div class="widget-title"><i class="fa fa-xie"> Letzte</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/Nginx 各种实验演示/">Nginx 各种实验演示</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/Nginx 详细介绍/">Nginx 详细介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/日志管理介绍/">日志管理介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/09/Linux 防火墙各种规则实战应用/">Linux 防火墙各种规则实战应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/15/memcache  缓存原理介绍/">memcache  缓存原理介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/08/tomcat 各种架构实验演示/">tomcat 各种架构实验演示</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/05/浅谈 tomcat 原理/">浅谈 tomcat 原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/25/Varnish 缓存服务器介绍/">Varnish 缓存服务器介绍</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/14/keepalived 各种高可用实战演练/">keepalived 各种高可用实战演练</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/09/08/keepalived高可用/">keepalived  高可用</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-biao"> Tags</i></div><div class="tagcloud"><a href="/tags/varnish/" style="font-size: 15px;">varnish</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/haproxy/" style="font-size: 15px;">haproxy</a> <a href="/tags/DNS/" style="font-size: 15px;">DNS</a> <a href="/tags/LAMP/" style="font-size: 15px;">LAMP</a> <a href="/tags/权限管理/" style="font-size: 15px;">权限管理</a> <a href="/tags/练习题/" style="font-size: 15px;">练习题</a> <a href="/tags/用户组/" style="font-size: 15px;">用户组</a> <a href="/tags/su和sudo/" style="font-size: 15px;">su和sudo</a> <a href="/tags/MYSQL/" style="font-size: 15px;">MYSQL</a> <a href="/tags/文件系统/" style="font-size: 15px;">文件系统</a> <a href="/tags/SSH/" style="font-size: 15px;">SSH</a> <a href="/tags/TCP-IP/" style="font-size: 15px;">TCP/IP</a> <a href="/tags/mysql/" style="font-size: 15px;">mysql</a> <a href="/tags/DHCP/" style="font-size: 15px;">DHCP</a> <a href="/tags/keepalied/" style="font-size: 15px;">keepalied</a> <a href="/tags/lvs/" style="font-size: 15px;">lvs</a> <a href="/tags/memcache/" style="font-size: 15px;">memcache</a> <a href="/tags/rpm/" style="font-size: 15px;">rpm</a> <a href="/tags/tomcat/" style="font-size: 15px;">tomcat</a> <a href="/tags/共享服务/" style="font-size: 15px;">共享服务</a> <a href="/tags/自动化安装/" style="font-size: 15px;">自动化安装</a> <a href="/tags/基本命令/" style="font-size: 15px;">基本命令</a> <a href="/tags/CA/" style="font-size: 15px;">CA</a> <a href="/tags/dns/" style="font-size: 15px;">dns</a> <a href="/tags/sed/" style="font-size: 15px;">sed</a> <a href="/tags/mini系统/" style="font-size: 15px;">mini系统</a> <a href="/tags/进程管理、计划任务/" style="font-size: 15px;">进程管理、计划任务</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-archive"> Archiv</i></div><ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-you"> Blogroll</i></div><ul></ul><a href="http://www.example1.com/" title="site-name1" target="_blank">site-name1</a><ul></ul><a href="http://www.example2.com/" title="site-name2" target="_blank">site-name2</a><ul></ul><a href="http://www.example3.com/" title="site-name3" target="_blank">site-name3</a></div></div></div></div><a id="totop" href="#top"></a><div id="footer"><div class="footer-info"><p><a href="/baidusitemap.xml">Baidu Site Haritası</a> |  <a href="/atom.xml">RSS</a> |  <a href="/about/">Über</a></p><p>本站总访问量：<i id="busuanzi_container_site_pv"><i id="busuanzi_value_site_pv"></i></i>次</p><p><span> Copyright &copy;<a href="/." rel="nofollow">John Doe.</a></span><span> Theme by<a rel="nofollow" target="_blank" href="https://github.com/chaooo/hexo-theme-BlueLake"> BlueLake.</a></span><span> Count by<a href="http://busuanzi.ibruce.info/"> busuanzi.</a></span><span> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a></span></p></div></div></div><script src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js" async></script><script type="text/javascript" src="/js/search.json.js?v=2.0.1"></script><script type="text/javascript" src="/js/toctotop.js?v=2.0.1" async></script><script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":["mshare","weixin","tsina","qzone","linkedin","fbook","twi","print","renren","sqq","evernotecn","bdysc","tqq","tqf","bdxc","kaixin001","tieba","douban","bdhome","thx","ibaidu","meilishuo","mogujie","diandian","huaban","duitang","hx","fx","youdao","sdo","qingbiji","people","xinhua","mail","isohu","yaolan","wealink","ty","iguba","h163","copy"],"bdPic":"","bdStyle":"1","bdSize":"16"},"share":{},"image":{"viewList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["tsina","qzone","weixin","fbook","twi","linkedin","youdao","evernotecn","mshare"]}};with(document)0[(getElementsByTagName('head')[0]||head).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script></body></html>