<!DOCTYPE html>
<html>
    <!-- title -->




<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" >
    <meta name="author" content="John Doe">
    <meta name="renderer" content="webkit">
    <meta name="copyright" content="John Doe">
    <meta name="keywords" content="Hexo | John Doe">
    <meta name="description" content="">
    <meta name="Cache-Control" content="no-cache">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <title>MYSQL 数据库的日志介绍 · 李登峰</title>
    <style type="text/css">
    @font-face {
        font-family: 'Oswald-Regular';
        src: url("/font/Oswald-Regular.ttf");
    }

    body {
        margin: 0;
    }

    header,
    footer,
    .back-top,
    .sidebar,
    .container,
    .site-intro-meta,
    .toc-wrapper {
        display: none;
    }

    .site-intro {
        position: relative;
        z-index: 3;
        width: 100%;
        /* height: 50vh; */
        overflow: hidden;
    }

    .site-intro-placeholder {
        position: absolute;
        z-index: -2;
        top: 0;
        left: 0;
        width: calc(100% + 300px);
        height: 100%;
        background: repeating-linear-gradient(-45deg, #444 0, #444 80px, #333 80px, #333 160px);
        background-position: center center;
        transform: translate3d(-226px, 0, 0);
        animation: gradient-move 2.5s ease-out 0s 1;
    }

    @keyframes gradient-move {
        0% {
            transform: translate3d(-226px, 0, 0);
        }
        100% {
            transform: translate3d(0, 0, 0);
        }
    }

</style>

    <link rel="preload" href= /css/style.css?v=20180630 as="style" onload="this.onload=null;this.rel='stylesheet'" />
    <link rel="stylesheet" href= /css/mobile.css?v=20180630 media="(max-width: 980px)">
    
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'" />
    
    <!-- /*! loadCSS. [c]2017 Filament Group, Inc. MIT License */
/* This file is meant as a standalone workflow for
- testing support for link[rel=preload]
- enabling async CSS loading in browsers that do not support rel=preload
- applying rel preload css once loaded, whether supported or not.
*/ -->
<script>
(function( w ){
	"use strict";
	// rel=preload support test
	if( !w.loadCSS ){
		w.loadCSS = function(){};
	}
	// define on the loadCSS obj
	var rp = loadCSS.relpreload = {};
	// rel=preload feature support test
	// runs once and returns a function for compat purposes
	rp.support = (function(){
		var ret;
		try {
			ret = w.document.createElement( "link" ).relList.supports( "preload" );
		} catch (e) {
			ret = false;
		}
		return function(){
			return ret;
		};
	})();

	// if preload isn't supported, get an asynchronous load by using a non-matching media attribute
	// then change that media back to its intended value on load
	rp.bindMediaToggle = function( link ){
		// remember existing media attr for ultimate state, or default to 'all'
		var finalMedia = link.media || "all";

		function enableStylesheet(){
			link.media = finalMedia;
		}

		// bind load handlers to enable media
		if( link.addEventListener ){
			link.addEventListener( "load", enableStylesheet );
		} else if( link.attachEvent ){
			link.attachEvent( "onload", enableStylesheet );
		}

		// Set rel and non-applicable media type to start an async request
		// note: timeout allows this to happen async to let rendering continue in IE
		setTimeout(function(){
			link.rel = "stylesheet";
			link.media = "only x";
		});
		// also enable media after 3 seconds,
		// which will catch very old browsers (android 2.x, old firefox) that don't support onload on link
		setTimeout( enableStylesheet, 3000 );
	};

	// loop through link elements in DOM
	rp.poly = function(){
		// double check this to prevent external calls from running
		if( rp.support() ){
			return;
		}
		var links = w.document.getElementsByTagName( "link" );
		for( var i = 0; i < links.length; i++ ){
			var link = links[ i ];
			// qualify links to those with rel=preload and as=style attrs
			if( link.rel === "preload" && link.getAttribute( "as" ) === "style" && !link.getAttribute( "data-loadcss" ) ){
				// prevent rerunning on link
				link.setAttribute( "data-loadcss", true );
				// bind listeners to toggle media back
				rp.bindMediaToggle( link );
			}
		}
	};

	// if unsupported, run the polyfill
	if( !rp.support() ){
		// run once at least
		rp.poly();

		// rerun poly on an interval until onload
		var run = w.setInterval( rp.poly, 500 );
		if( w.addEventListener ){
			w.addEventListener( "load", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		} else if( w.attachEvent ){
			w.attachEvent( "onload", function(){
				rp.poly();
				w.clearInterval( run );
			} );
		}
	}


	// commonjs
	if( typeof exports !== "undefined" ){
		exports.loadCSS = loadCSS;
	}
	else {
		w.loadCSS = loadCSS;
	}
}( typeof global !== "undefined" ? global : this ) );
</script>

    <link rel="icon" href= "/assets/favicon.ico" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js" as="script" />
    <link rel="preload" href="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js" as="script" />
    <link rel="preload" href="/scripts/main.js" as="script" />
    <link rel="preload" as="font" href="/font/Oswald-Regular.ttf" crossorigin>
    <link rel="preload" as="font" href="https://at.alicdn.com/t/font_327081_1dta1rlogw17zaor.woff" crossorigin>
    
    <!-- fancybox -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.2.5/jquery.fancybox.min.js" defer></script>
    <!-- 百度统计  -->
    
    <!-- 谷歌统计  -->
    
</head>

    
        <body class="post-body">
    
    
<header class="header">

    <div class="read-progress"></div>
    <div class="header-sidebar-menu">&#xe775;</div>
    <!-- post页的toggle banner  -->
    
    <div class="banner">
            <div class="blog-title">
                <a href="/" >博客</a>
            </div>
            <div class="post-title">
                <a href="#" class="post-name">MYSQL 数据库的日志介绍</a>
            </div>
    </div>
    
    <a class="home-link" href=/>博客</a>
</header>
    <div class="wrapper">
        <div class="site-intro" style=








height:50vh;

>
    
    <!-- 主页  -->
    
    
    <!-- 404页  -->
            
    <div class="site-intro-placeholder"></div>
    <div class="site-intro-img" style="background-image: url(/intro/post-bg.jpg)"></div>
    <div class="site-intro-meta">
        <!-- 标题  -->
        <h1 class="intro-title">
            <!-- 主页  -->
            
            MYSQL 数据库的日志介绍
            <!-- 404 -->
            
        </h1>
        <!-- 副标题 -->
        <p class="intro-subtitle">
            <!-- 主页副标题  -->
            
            
            <!-- 404 -->
            
        </p>
        <!-- 文章页meta -->
        
            <div class="post-intros">
                <!-- 文章页标签  -->
                
                    <div class= post-intro-tags >
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "Linux">Linux</a>
    
        <a class="post-tag" href="javascript:void(0);" data-tags = "MYSQL">MYSQL</a>
    
</div>
                
                
                    <div class="post-intro-read">
                        <span>Word count: <span class="post-count">8,370</span> / Reading time: <span class="post-count">37 min</span></span>
                    </div>
                
                <div class="post-intro-meta">
                    <span class="post-intro-calander iconfont-archer">&#xe676;</span>
                    <span class="post-intro-time">2017/05/22</span>
                    
                    <span id="busuanzi_container_page_pv" class="busuanzi-pv">
                        <span class="iconfont-archer">&#xe602;</span>
                        <span id="busuanzi_value_page_pv"></span>
                    </span>
                    
                    <span class="shareWrapper">
                        <span class="iconfont-archer shareIcon">&#xe71d;</span>
                        <span class="shareText">Share</span>
                        <ul class="shareList">
                            <li class="iconfont-archer share-qr" data-type="qr">&#xe75b;
                                <div class="share-qrcode"></div>
                            </li>
                            <li class="iconfont-archer" data-type="weibo">&#xe619;</li>
                            <li class="iconfont-archer" data-type="qzone">&#xe62e;</li>
                            <li class="iconfont-archer" data-type="twitter">&#xe634;</li>
                            <li class="iconfont-archer" data-type="facebook">&#xe67a;</li>
                        </ul>
                    </span>
                </div>
            </div>
        
    </div>
</div> 
        <script>
 
  // get user agent
  var browser = {
    versions: function () {
      var u = window.navigator.userAgent;
      return {
        userAgent: u,
        trident: u.indexOf('Trident') > -1, //IE内核
        presto: u.indexOf('Presto') > -1, //opera内核
        webKit: u.indexOf('AppleWebKit') > -1, //苹果、谷歌内核
        gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') == -1, //火狐内核
        mobile: !!u.match(/AppleWebKit.*Mobile.*/), //是否为移动终端
        ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/), //ios终端
        android: u.indexOf('Android') > -1 || u.indexOf('Linux') > -1, //android终端或者uc浏览器
        iPhone: u.indexOf('iPhone') > -1 || u.indexOf('Mac') > -1, //是否为iPhone或者安卓QQ浏览器
        iPad: u.indexOf('iPad') > -1, //是否为iPad
        webApp: u.indexOf('Safari') == -1, //是否为web应用程序，没有头部与底部
        weixin: u.indexOf('MicroMessenger') == -1, //是否为微信浏览器
        uc: u.indexOf('UCBrowser') > -1 //是否为android下的UC浏览器
      };
    }()
  }
  console.log("userAgent:" + browser.versions.userAgent);

  // callback
  function fontLoaded() {
    console.log('font loaded');
    if (document.getElementsByClassName('site-intro-meta')) {
      document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
      document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
      var postIntros = document.getElementsByClassName('post-intros')[0]
      if (postIntros) {
        postIntros.classList.add('post-fade-in');
      }
    }
  }

  // UC不支持跨域，所以直接显示
  function asyncCb(){
    if (browser.versions.uc) {
      console.log("UCBrowser");
      fontLoaded();
    } else {
      WebFont.load({
        custom: {
          families: ['Oswald-Regular']
        },
        loading: function () {  //所有字体开始加载
          // console.log('loading');
        },
        active: function () {  //所有字体已渲染
          fontLoaded();
        },
        inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
          console.log('inactive: timeout');
          fontLoaded();
        },
        timeout: 5000 // Set the timeout to two seconds
      });
    }
  }

  function asyncErr(){
    console.warn('script load from CDN failed, will load local script')
  }

  // load webfont-loader async, and add callback function
  function async(u, cb, err) {
    var d = document, t = 'script',
      o = d.createElement(t),
      s = d.getElementsByTagName(t)[0];
    o.src = u;
    if (cb) { o.addEventListener('load', function (e) { cb(null, e); }, false); }
    if (err) { o.addEventListener('error', function (e) { err(null, e); }, false); }
    s.parentNode.insertBefore(o, s);
  }

  var asyncLoadWithFallBack = function(arr, success, reject) {
      var currReject = function(){
        reject()
        arr.shift()
        if(arr.length)
          async(arr[0], success, currReject)
        }

      async(arr[0], success, currReject)
  }

  asyncLoadWithFallBack([
    "https://cdn.jsdelivr.net/npm/webfontloader@1.6.28/webfontloader.min.js", 
    "https://cdn.bootcss.com/webfont/1.6.28/webfontloader.js",
    "/lib/webfontloader.min.js"
  ], asyncCb, asyncErr)
</script>        
        <img class="loading" src="/assets/loading.svg" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <div class="container container-unloaded">
            <main class="main post-page">
    <article class="article-entry">
        <p>不管是哪个数据库产品，一定会有日志文件。在MariaDB/MySQL中，主要有5种日志文件：  </p>
<p>1.错误日志(error log)：记录mysql服务的启停时正确和错误的信息，还记录启动、停止、运行过程中的错误信息。  </p>
<p>2.查询日志(general log)：记录建立的客户端连接和执行的语句。  </p>
<p>3.二进制日志(bin log)：记录所有更改数据的语句，可用于数据复制。  </p>
<p>4.慢查询日志(slow log)：记录所有执行时间超过long_query_time的所有查询或不使用索引的查询。  </p>
<p>5.中继日志(relay log)：主从复制时使用的日志。  </p>
<a id="more"></a>
<h4 id="日志刷新操作"><a href="#日志刷新操作" class="headerlink" title="日志刷新操作"></a>日志刷新操作</h4><blockquote>
<p>以下操作会刷新日志文件，刷新日志文件时会关闭旧的日志文件并重新打开日志文件。对于有些日志类型，如二进制日志，刷新日志会滚动日志文件，而不仅仅是关闭并重新打开。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; FLUSH LOGS;</span><br><span class="line">shell&gt; mysqladmin flush-logs</span><br><span class="line">shell&gt; mysqladmin refresh</span><br></pre></td></tr></table></figure>
<h4 id="错误日志"><a href="#错误日志" class="headerlink" title="错误日志"></a>错误日志</h4><blockquote>
<p>错误日志是最重要的日志之一，它记录了MariaDB/MySQL服务启动和停止正确和错误的信息，还记录了mysqld实例运行过程中发生的错误事件信息。  </p>
<p>可以使用” –log-erroe=[file_name] “来指定mysqld记录的错误日志文件，如果没有指定file_name，则默认的错误日志文件为datadir目录下的 <code>hostname</code>.err ，hostname表示当前的主机名。  </p>
</blockquote>
<blockquote>
<p>也可以在MariaDB/MySQL配置文件中的mysqld配置部分，使用log-error指定错误日志的路径。  </p>
</blockquote>
<h6 id="如果不知道错误日志的位置，可以查看变量log-error来查看。"><a href="#如果不知道错误日志的位置，可以查看变量log-error来查看。" class="headerlink" title="如果不知道错误日志的位置，可以查看变量log_error来查看。"></a>如果不知道错误日志的位置，可以查看变量log_error来查看。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;log_error&apos;;</span><br><span class="line">+---------------+----------------------------------------+</span><br><span class="line">| Variable_name | Value                                  |</span><br><span class="line">+---------------+----------------------------------------+</span><br><span class="line">| log_error     | /var/lib/mysql/node1.longshuai.com.err |</span><br><span class="line">+---------------+----------------------------------------+</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在MySQL 5.5.7之前，刷新日志操作(如flush logs)会备份旧的错误日志(以_old结尾)，并创建一个新的错误日志文件并打开，在MySQL 5.5.7之后，执行刷新日志的操作时，错误日志会关闭并重新打开，如果错误日志不存在，则会先创建。   </p>
</blockquote>
<blockquote>
<p>在MariaDB/MySQL正在运行状态下删除错误日志后，不会自动创建错误日志，只有在刷新日志的时候才会创建一个新的错误日志文件。   </p>
</blockquote>
<blockquote>
<p>以下是MySQL 5.6.35启动的日志信息。   </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">2017-03-29 01:15:14 2362 [Note] Plugin &apos;FEDERATED&apos; is disabled.</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Using atomics to ref count buffer pool pages</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: The InnoDB memory heap is disabled</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Mutexes and rw_locks use GCC atomic builtins</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Memory barrier is not used</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Compressed tables use zlib 1.2.3</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Using Linux native AIO</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Using CPU crc32 instructions</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Initializing buffer pool, size = 128.0M</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Completed initialization of buffer pool</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Highest supported file format is Barracuda.</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: 128 rollback segment(s) are active.</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: Waiting for purge to start</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] InnoDB: 5.6.35 started; log sequence number 3911610</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] Server hostname (bind-address): &apos;*&apos;; port: 3306</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] IPv6 is available.</span><br><span class="line">2017-03-29 01:15:14 2362 [Note]   - &apos;::&apos; resolves to &apos;::&apos;;</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] Server socket created on IP: &apos;::&apos;.</span><br><span class="line">2017-03-29 01:15:14 2362 [Warning] &apos;proxies_priv&apos; entry &apos;@ root@xuexi.longshuai.com&apos; ignored in --skip-name-resolve mode.</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] Event Scheduler: Loaded 0 events</span><br><span class="line">2017-03-29 01:15:14 2362 [Note] /usr/local/mysql/bin/mysqld: ready for connections.</span><br><span class="line">Version: &apos;5.6.35&apos;  socket: &apos;/mydata/data/mysql.sock&apos;  port: 3306  MySQL Community Server (GPL)</span><br></pre></td></tr></table></figure>
<h4 id="一般查询日志"><a href="#一般查询日志" class="headerlink" title="一般查询日志"></a>一般查询日志</h4><blockquote>
<p>查询日志分为一般查询日志和慢查询日志，它们是通过查询是否超出变量 long_query_time 指定时间的值来判定的。在超时时间内完成的查询是一般查询，可以将其记录到一般查询日志中，但是建议关闭这种日志（默认是关闭的），超出时间的查询是慢查询，可以将其记录到慢查询日志中。  </p>
</blockquote>
<blockquote>
<p>使用” –general_log={0|1} “来决定是否启用一般查询日志，使用” –general_log_file=file_name “来指定查询日志的路径。不给定路径时默认的文件名以 <code>hostname</code>.log 命名。  </p>
</blockquote>
<p>和查询日志有关的变量有：  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">1 long_query_time = 10 # 指定慢查询超时时长，超出此时长的属于慢查询，会记录到慢查询日志中  </span><br><span class="line"></span><br><span class="line">2 log_output=&#123;TABLE|FILE|NONE&#125;  # 定义一般查询日志和慢查询日志的输出格式，不指定时默认为file</span><br></pre></td></tr></table></figure>
<blockquote>
<p>TABLE表示记录日志到表中，FILE表示记录日志到文件中，NONE表示不记录日志。只要这里指定为NONE，即使开启了一般查询日志和慢查询日志，也都不会有任何记 录。  </p>
</blockquote>
<h6 id="和一般查询日志相关的变量有："><a href="#和一般查询日志相关的变量有：" class="headerlink" title="和一般查询日志相关的变量有："></a>和一般查询日志相关的变量有：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1 general_log=off # 是否启用一般查询日志，为全局变量，必须在global上修改。  </span><br><span class="line"></span><br><span class="line">2 sql_log_off=off # 在session级别控制是否启用一般查询日志，默认为off，即启用  </span><br><span class="line"></span><br><span class="line">3 general_log_file=/mydata/data/hostname.log  # 默认是库文件路径下主机名加上.log</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在MySQL 5.6以前的版本还有一个”log”变量也是决定是否开启一般查询日志的。在5.6版本开始已经废弃了该选项。  </p>
</blockquote>
<blockquote>
<p>默认没有开启一般查询日志，也不建议开启一般查询日志。此处打开该类型的日志，看看是如何记录一般查询日志的。  </p>
</blockquote>
<blockquote>
<p>首先开启一般查询日志。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set @@global.general_log=1;</span><br><span class="line"></span><br><span class="line">[root@xuexi data]# ll *.log</span><br><span class="line">-rw-rw---- 1 mysql mysql 5423 Mar 20 16:29 mysqld.log</span><br><span class="line">-rw-rw---- 1 mysql mysql  262 Mar 29 09:31 xuexi.log</span><br></pre></td></tr></table></figure>
<h6 id="执行几个语句。"><a href="#执行几个语句。" class="headerlink" title="执行几个语句。"></a>执行几个语句。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select host,user from mysql.user;</span><br><span class="line">mysql&gt; show variables like &quot;%error%&quot;;</span><br><span class="line">mysql&gt; insert into ttt values(233);</span><br><span class="line">mysql&gt; create table tt(id int);</span><br><span class="line">mysql&gt; set @a:=3;</span><br></pre></td></tr></table></figure>
<h6 id="查看一般查询日志的内容。"><a href="#查看一般查询日志的内容。" class="headerlink" title="查看一般查询日志的内容。"></a>查看一般查询日志的内容。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# cat xuexi.log </span><br><span class="line">/usr/local/mysql/bin/mysqld, Version: 5.6.35-log (MySQL Community Server (GPL)). started with:</span><br><span class="line">Tcp port: 3306  Unix socket: /mydata/data/mysql.sock</span><br><span class="line">Time                Id Command    Argument</span><br><span class="line">180421 20:04:41     13 Query      select user,host from mysql.user</span><br><span class="line">180421 20:06:06     13 Query      show variables like &quot;%error%&quot;</span><br><span class="line">180421 20:07:28     13 Query      insert into ttt values(233)</span><br><span class="line">180421 20:11:47     13 Query      create table tt(id int)</span><br><span class="line">180421 20:12:29     13 Query      set @a:=3</span><br></pre></td></tr></table></figure>
<h6 id="由此可知，一般查询日志查询的不止是select语句，几乎所有的语句都会记录。"><a href="#由此可知，一般查询日志查询的不止是select语句，几乎所有的语句都会记录。" class="headerlink" title="由此可知，一般查询日志查询的不止是select语句，几乎所有的语句都会记录。"></a>由此可知，一般查询日志查询的不止是select语句，几乎所有的语句都会记录。</h6><h4 id="慢查询日志"><a href="#慢查询日志" class="headerlink" title="慢查询日志"></a>慢查询日志</h4><blockquote>
<p>查询超出变量 long_query_time 指定时间值的为慢查询。但是查询获取锁(包括锁等待)的时间不计入查询时间内。  </p>
</blockquote>
<blockquote>
<p>mysql记录慢查询日志是在查询执行完毕且已经完全释放锁之后才记录的，因此慢查询日志记录的顺序和执行的SQL查询语句顺序可能会不一致(例如语句1先执行，查询速度慢，语句2后执行，但查询速度快，则语句2先记录)。  </p>
</blockquote>
<blockquote>
<p>注意，MySQL 5.1之后就支持微秒级的慢查询超时时长，对于DBA来说，一个查询运行0.5秒和运行0.05秒是非常不同的，前者可能索引使用错误或者走了表扫描，后者可能索引使用正确。  </p>
</blockquote>
<blockquote>
<p>另外，指定的慢查询超时时长表示的是超出这个时间的才算是慢查询，等于这个时间的不会记录。  </p>
</blockquote>
<h6 id="和慢查询有关的变量："><a href="#和慢查询有关的变量：" class="headerlink" title="和慢查询有关的变量："></a>和慢查询有关的变量：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1 long_query_time=10 # 指定慢查询超时时长(默认10秒)，超出此时长的属于慢查询  </span><br><span class="line"></span><br><span class="line">2 log_output=&#123;TABLE|FILE|NONE&#125; # 定义一般查询日志和慢查询日志的输出格式，默认为file  </span><br><span class="line"></span><br><span class="line">3 log_slow_queries=&#123;yes|no&#125;    # 是否启用慢查询日志，默认不启用  </span><br><span class="line"></span><br><span class="line">4 slow_query_log=&#123;1|ON|0|OFF&#125;  # 也是是否启用慢查询日志，此变量和log_slow_queries修改一个另一个同时变化  </span><br><span class="line"></span><br><span class="line">5 slow_query_log_file=/mydata/data/hostname-slow.log  #默认路径为库文件目录下主机名加上-slow.log  </span><br><span class="line"></span><br><span class="line">6 log_queries_not_using_indexes=OFF # 查询没有使用索引的时候是否也记入慢查询日志</span><br></pre></td></tr></table></figure>
<blockquote>
<p>现在启用慢查询日志。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set @@global.slow_query_log=on;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>因为默认超时时长为10秒，所以进行一个10秒的查询。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select sleep(10);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>查看慢查询日志文件。这里看到虽然sleep了10秒，但是最后查询时间超出了847微秒，因此这里也记录了该查询。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# cat xuexi-slow.log </span><br><span class="line">/usr/local/mysql/bin/mysqld, Version: 5.6.35-log (MySQL Community Server (GPL)). started with:</span><br><span class="line">Tcp port: 3306  Unix socket: /mydata/data/mysql.sock</span><br><span class="line">Time                 Id Command    Argument</span><br><span class="line"># Time: 170329  9:55:58</span><br><span class="line"># User@Host: root[root] @ localhost []  Id:     1</span><br><span class="line"># Query_time: 10.000847  Lock_time: 0.000000 Rows_sent: 1  Rows_examined: 0</span><br><span class="line">use test;</span><br><span class="line">SET timestamp=1490752558;</span><br><span class="line">select sleep(10);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>随着时间的推移，慢查询日志文件中的记录可能会变得非常多，这对于分析查询来说是非常困难的。好在提供了一个专门归类慢查询日志的工具mysqldumpslow。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqldumpslow --help  </span><br><span class="line"></span><br><span class="line">  -d           debug   </span><br><span class="line">  </span><br><span class="line">  -v           verbose：显示详细信息  </span><br><span class="line">  </span><br><span class="line">  -t NUM       just show the top n  queries：仅显示前n条查询  </span><br><span class="line">  </span><br><span class="line">  -a           don&apos;t abstract all numbers to N and strings to &apos;S&apos;：归类时不要使用N替换数字，S替换字符串  </span><br><span class="line">  </span><br><span class="line">  -g PATTERN   grep: only consider stmts that include this string：通过grep来筛选select语句。</span><br></pre></td></tr></table></figure>
<blockquote>
<p>该工具归类的时候，默认会将同文本但变量值不同的查询语句视为同一类，并使用N代替其中的数值变量，使用S代替其中的字符串变量。可以使用-a来禁用这种替换。如：  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqldumpslow xuexi-slow.log </span><br><span class="line">Reading mysql slow query log from xuexi-slow.log</span><br><span class="line">Count: 1  Time=10.00s (10s)  Lock=0.00s (0s)  Rows=1.0 (1), root[root]@localhost</span><br><span class="line">  select sleep(N)</span><br><span class="line"></span><br><span class="line">[root@xuexi data]#  mysqldumpslow -a xuexi-slow.log   </span><br><span class="line">Reading mysql slow query log from xuexi-slow.log</span><br><span class="line">Count: 1  Time=10.00s (10s)  Lock=0.00s (0s)  Rows=1.0 (1), root[root]@localhost</span><br><span class="line">  select sleep(10)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>显然，这里归类后的结果只是精确到0.01秒的，如果想要显示及其精确的秒数，则使用-d选项启用调试功能。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]#  mysqldumpslow -d xuexi-slow.log   </span><br><span class="line">Reading mysql slow query log from xuexi-slow.log</span><br><span class="line">[[/usr/local/mysql/bin/mysqld, Version: 5.6.35-log (MySQL Community Server (GPL)). started with:</span><br><span class="line">Tcp port: 3306  Unix socket: /mydata/data/mysql.sock</span><br><span class="line">Time                 Id Command    Argument</span><br><span class="line"># Time: 170329  9:55:58</span><br><span class="line"># User@Host: root[root] @ localhost []  Id:     1</span><br><span class="line"># Query_time: 10.000847  Lock_time: 0.000000 Rows_sent: 1  Rows_examined: 0</span><br><span class="line">use test;</span><br><span class="line">SET timestamp=1490752558;</span><br><span class="line">select sleep(10);</span><br><span class="line">]]</span><br><span class="line">&lt;&lt;&gt;&gt;</span><br><span class="line">&lt;&lt;# Time: 170329  9:55:58</span><br><span class="line"># User@Host: root[root] @ localhost []  Id:     1</span><br><span class="line"># Query_time: 10.000847  Lock_time: 0.000000 Rows_sent: 1  Rows_examined: 0</span><br><span class="line">use test;</span><br><span class="line">SET timestamp=1490752558;</span><br><span class="line">select sleep(10);</span><br><span class="line">&gt;&gt; at /usr/local/mysql/bin/mysqldumpslow line 97, &lt;&gt; chunk 1.</span><br><span class="line">[[# Time: 170329  9:55:58</span><br><span class="line"># User@Host: root[root] @ localhost []  Id:     1</span><br><span class="line"># Query_time: 10.000847  Lock_time: 0.000000 Rows_sent: 1  Rows_examined: 0</span><br><span class="line">use test;</span><br><span class="line">SET timestamp=1490752558;</span><br><span class="line">select sleep(10);</span><br><span class="line">]]</span><br><span class="line">&#123;&#123;  select sleep(N)&#125;&#125;</span><br><span class="line"></span><br><span class="line">Count: 1  Time=10.00s (10s)  Lock=0.00s (0s)  Rows=1.0 (1), root[root]@localhost</span><br><span class="line">  select sleep(N)</span><br></pre></td></tr></table></figure>
<h6 id="慢查询在SQL语句调优的时候非常有用，应该将它启用起来。"><a href="#慢查询在SQL语句调优的时候非常有用，应该将它启用起来。" class="headerlink" title="慢查询在SQL语句调优的时候非常有用，应该将它启用起来。"></a>慢查询在SQL语句调优的时候非常有用，应该将它启用起来。</h6><h4 id="二进制日志"><a href="#二进制日志" class="headerlink" title="二进制日志"></a>二进制日志</h4><h5 id="二进制日志文件"><a href="#二进制日志文件" class="headerlink" title="二进制日志文件"></a>二进制日志文件</h5><blockquote>
<p>二进制日志包含了引起或可能引起数据库改变(如delete语句但没有匹配行)的事件信息，但绝不会包括select和show这样的查询语句。语句以”事件”的形式保存，所以包含了时间、事件开始和结束位置等信息。  </p>
</blockquote>
<blockquote>
<p>二进制日志是以事件形式记录的，不是事务日志(但可能是基于事务来记录二进制日志)，不代表它只记录innodb日志，myisam表也一样有二进制日志。  </p>
</blockquote>
<blockquote>
<p>二进制日志只在事务提交的时候一次性写入(基于事务的innodb二进制日志)。  </p>
</blockquote>
<blockquote>
<p>MariaDB/MySQL默认没有启动二进制日志，要启用二进制日志使用 –log-bin=[on|off|file_name] 选项指定，如果没有给定file_name，则默认为datadir下的主机名加”-bin”，并在后面跟上一串数字表示日志序列号，如果给定的日志文件中包含了后缀(logname.suffix)将忽略后缀部分。<br><img src="https://images2018.cnblogs.com/blog/733013/201805/733013-20180507084125816-1681048114.png" alt="image"></p>
</blockquote>
<blockquote>
<p>或者在配置文件中的[mysqld]部分设置log-bin也可以。注意：对于mysql 5.7，直接启动binlog可能会导致mysql服务启动失败，这时需要在配置文件中的mysqld为mysql实例分配server_id。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]  </span><br><span class="line"># server_id=1234  </span><br><span class="line">log-bin=[on|filename]</span><br></pre></td></tr></table></figure>
<blockquote>
<p>mysqld还创建一个二进制日志索引文件，当二进制日志文件滚动的时候会向该文件中写入对应的信息。所以该文件包含所有使用的二进制日志文件的文件名。默认情况下该文件与二进制日志文件的文件名相同，扩展名为’.index’。要指定该文件的文件名使用 –log-bin-index[=file_name] 选项。当mysqld在运行时不应手动编辑该文件，免得mysqld变得混乱。  </p>
<p>当重启mysql服务或刷新日志或者达到日志最大值时，将滚动二进制日志文件，滚动日志时只修改日志文件名的数字序列部分。  </p>
</blockquote>
<blockquote>
<p>二进制日志文件的最大值通过变量 max_binlog_size 设置(默认值为1G)。但由于二进制日志可能是基于事务来记录的(如innodb表类型)，而事务是绝对不可能也不应该跨文件记录的，如果正好二进制日志文件达到了最大值但事务还没有提交则不会滚动日志，而是继续增大日志，所以 max_binlog_size 指定的值和实际的二进制日志大小不一定相等。  </p>
</blockquote>
<blockquote>
<p>因为二进制日志文件增长迅速，但官方说明因此而损耗的性能小于1%，且二进制目的是为了恢复定点数据库和主从复制，所以出于安全和功能考虑，极不建议将二进制日志和datadir放在同一磁盘上。  </p>
</blockquote>
<h5 id="查看二进制日志"><a href="#查看二进制日志" class="headerlink" title="查看二进制日志"></a>查看二进制日志</h5><blockquote>
<p>MySQL中查看二进制日志的方法主要有几种。  </p>
</blockquote>
<blockquote>
<p>1.使用mysqlbinlog工具。  </p>
<p>2.使用show显示对应的信息。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SHOW &#123;BINARY | MASTER&#125; LOGS      # 查看使用了哪些日志文件  </span><br><span class="line"></span><br><span class="line">SHOW BINLOG EVENTS [IN &apos;log_name&apos;] [FROM pos]   # 查看日志中进行了哪些操作  </span><br><span class="line"></span><br><span class="line">SHOW MASTER STATUS         # 显式主服务器中的二进制日志信息</span><br></pre></td></tr></table></figure>
<h6 id="mysqlbinlog"><a href="#mysqlbinlog" class="headerlink" title="mysqlbinlog"></a>mysqlbinlog</h6><blockquote>
<p>二进制日志可以使用mysqlbinlog命令查看。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">mysqlbinlog [option] log-file1   log-file2...</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以下是常用的几个选项：</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-d,--database=name：只查看指定数据库的日志操作  </span><br><span class="line"></span><br><span class="line">-o,--offset=#：忽略掉日志中的前n个操作命令  </span><br><span class="line"></span><br><span class="line">-r,--result-file=name：将输出的日志信息输出到指定的文件中，使用重定向也一样可以。  </span><br><span class="line"></span><br><span class="line">-s,--short-form：显示简单格式的日志，只记录一些普通的语句，会省略掉一些额外的信息如位置信息和时间信息以及基于行的日志。可以用来调试，生产环境千万不可使用  </span><br><span class="line"></span><br><span class="line">--set-charset=char_name：在输出日志信息到文件中时，在文件第一行加上set names char_name  </span><br><span class="line"></span><br><span class="line">--start-datetime,--stop-datetime：指定输出开始时间和结束时间内的所有日志信息  </span><br><span class="line"></span><br><span class="line">--start-position=#,--stop-position=#：指定输出开始位置和结束位置内的所有日志信息  </span><br><span class="line"></span><br><span class="line">-v,-vv：显示更详细信息，基于row的日志默认不会显示出来，此时使用-v或-vv可以查看</span><br></pre></td></tr></table></figure>
<blockquote>
<p>在进行测试之前，先对日志进行一次刷新，以方便解释二进制日志的信息。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell&gt; mysqladmin -uroot -p refresh</span><br></pre></td></tr></table></figure>
<blockquote>
<p>假设现在的日志文件是mysql-bin.000001，里面暂时只有一些初始信息，没有记录任何操作过的记录。  </p>
</blockquote>
<blockquote>
<p>下面是每个二进制日志文件的初始信息。可以看到记录了时间和位置信息(at 4)。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 </span><br><span class="line">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/;</span><br><span class="line">/*!40019 SET @@session.max_insert_delayed_threads=0*/;</span><br><span class="line">/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/;</span><br><span class="line">DELIMITER /*!*/;</span><br><span class="line"># at 4</span><br><span class="line">#170329  2:18:10 server id 1  end_log_pos 120 CRC32 0x40f62523  Start: binlog v 4, server v 5.6.35-log created 170329  2:18:10 at startup</span><br><span class="line"># Warning: this binlog is either in use or was not closed properly.</span><br><span class="line">ROLLBACK/*!*/;</span><br><span class="line">BINLOG &apos;</span><br><span class="line">4qjaWA8BAAAAdAAAAHgAAAABAAQANS42LjM1LWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAADiqNpYEzgNAAgAEgAEBAQEEgAAXAAEGggAAAAICAgCAAAACgoKGRkAASMl</span><br><span class="line">9kA=</span><br><span class="line">&apos;/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line"># End of log file</span><br><span class="line">ROLLBACK /* added by mysqlbinlog */;</span><br><span class="line">/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/;</span><br><span class="line">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/;</span><br></pre></td></tr></table></figure>
<h6 id="现在在数据库中执行下面的操作："><a href="#现在在数据库中执行下面的操作：" class="headerlink" title="现在在数据库中执行下面的操作："></a>现在在数据库中执行下面的操作：</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">use test;</span><br><span class="line">create table student(studentid int not null primary key,name varchar(30) not null,gender enum(&apos;female&apos;,&apos;mail&apos;));</span><br><span class="line">alter table student change gender gender enum(&apos;female&apos;,&apos;male&apos;);</span><br><span class="line">insert into student values(1,&apos;malongshuai&apos;,&apos;male&apos;),(2,&apos;gaoxiaofang&apos;,&apos;female&apos;);</span><br></pre></td></tr></table></figure>
<h6 id="再查看二进制日志信息。"><a href="#再查看二进制日志信息。" class="headerlink" title="再查看二进制日志信息。"></a>再查看二进制日志信息。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 </span><br><span class="line">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=1*/;</span><br><span class="line">/*!40019 SET @@session.max_insert_delayed_threads=0*/;</span><br><span class="line">/*!50003 SET @OLD_COMPLETION_TYPE=@@COMPLETION_TYPE,COMPLETION_TYPE=0*/;</span><br><span class="line">DELIMITER /*!*/;</span><br><span class="line"># at 4</span><br><span class="line">#170329  2:18:10 server id 1  end_log_pos 120 CRC32 0x40f62523  Start: binlog v 4, server v 5.6.35-log created 170329  2:18:10 at startup</span><br><span class="line"># Warning: this binlog is either in use or was not closed properly.</span><br><span class="line">ROLLBACK/*!*/;</span><br><span class="line">BINLOG &apos;</span><br><span class="line">4qjaWA8BAAAAdAAAAHgAAAABAAQANS42LjM1LWxvZwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</span><br><span class="line">AAAAAAAAAAAAAAAAAADiqNpYEzgNAAgAEgAEBAQEEgAAXAAEGggAAAAICAgCAAAACgoKGRkAASMl</span><br><span class="line">9kA=</span><br><span class="line">&apos;/*!*/;</span><br><span class="line"># at 120</span><br><span class="line">#170329  5:20:00 server id 1  end_log_pos 305 CRC32 0xbac43912  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">use `test`/*!*/;</span><br><span class="line">SET TIMESTAMP=1490736000/*!*/;</span><br><span class="line">SET @@session.pseudo_thread_id=1/*!*/;</span><br><span class="line">SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;</span><br><span class="line">SET @@session.sql_mode=1075838976/*!*/;</span><br><span class="line">SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;</span><br><span class="line">/*!\C utf8 *//*!*/;</span><br><span class="line">SET @@session.character_set_client=33,@@session.collation_connection=33,@@session.collation_server=8/*!*/;</span><br><span class="line">SET @@session.lc_time_names=0/*!*/;</span><br><span class="line">SET @@session.collation_database=DEFAULT/*!*/;</span><br><span class="line">create table student(studentid int not null primary key,name varchar(30) not null,gender enum(&apos;female&apos;,&apos;mail&apos;))</span><br><span class="line">/*!*/;</span><br><span class="line"># at 305</span><br><span class="line">#170329  5:21:21 server id 1  end_log_pos 441 CRC32 0xde67f702  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736081/*!*/;</span><br><span class="line">alter table student change gender gender enum(&apos;female&apos;,&apos;male&apos;)</span><br><span class="line">/*!*/;</span><br><span class="line"># at 441</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 520 CRC32 0x05a9c5a1  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736093/*!*/;</span><br><span class="line">BEGIN</span><br><span class="line">/*!*/;</span><br><span class="line"># at 520</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 671 CRC32 0xad9e7dc8  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736093/*!*/;</span><br><span class="line">insert into student values(1,&apos;malongshuai&apos;,&apos;male&apos;),(2,&apos;gaoxiaofang&apos;,&apos;female&apos;)</span><br><span class="line">/*!*/;</span><br><span class="line"># at 671</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 702 CRC32 0xb69b0f7d  Xid = 32</span><br><span class="line">COMMIT/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line"># End of log file</span><br><span class="line">ROLLBACK /* added by mysqlbinlog */;</span><br><span class="line">/*!50003 SET COMPLETION_TYPE=@OLD_COMPLETION_TYPE*/;</span><br><span class="line">/*!50530 SET @@SESSION.PSEUDO_SLAVE_MODE=0*/;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>将上述信息整理为下图：其中timestamp记录的是从1970-01-01到现在的总秒数时间戳，可以使用 date -d ‘@1490736093’ 转换。  </p>
</blockquote>
<p><img src="https://images2018.cnblogs.com/blog/733013/201805/733013-20180507085958196-1633846460.png" alt="image"></p>
<blockquote>
<p>位置0-120记录的是二进制日志的一些固定信息。  </p>
</blockquote>
<blockquote>
<p>位置120-305记录的是use和create table语句，语句的记录时间为5:20:00。但注意，这里的use不是执行的use语句，而是MySQL发现要操作的数据库为test，而自动进行的操作并记录下来。人为的use语句是不会记录的。  </p>
</blockquote>
<blockquote>
<p>位置305-441记录的是alter table语句，语句的记录时间为5:20:21。  </p>
</blockquote>
<blockquote>
<p>位置441-702记录的是insert操作，因为该操作是DML语句，因此记录了事务的开始BEGIN和提交COMMIT。<br>begin的起止位置为441-520；<br>insert into语句的起止位置为520-671，记录的时间和自动开启事务的begin时间是一样的；<br>commit的起止位置为671-702。  </p>
</blockquote>
<blockquote>
<p>使用-r命令将日志文件导入到指定文件中，使用重定向也可以实现同样的结果。并使用-s查看简化的日志文件。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 -r /tmp/binlog.000001</span><br><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 -s&gt;/tmp/binlog.sample</span><br></pre></td></tr></table></figure>
<blockquote>
<p>比较这两个文件，看看简化的日志文件简化了哪些东西。<br><img src="https://images2018.cnblogs.com/blog/733013/201805/733013-20180507090446176-118990478.png" alt="image"></p>
</blockquote>
<blockquote>
<p>从上图中可以看出，使用-s后，少了基于行的日志信息，也少了记录的位置和时间信息。  </p>
</blockquote>
<blockquote>
<p>使用-o可以忽略前N个条目，例如上面的操作涉及了6个操作。忽略掉前3个后的日志显示如下：可以看到直接从位置441开始显示了。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 -o 3</span><br><span class="line">...前面固定部分省略...</span><br><span class="line"></span><br><span class="line">&apos;/*!*/;</span><br><span class="line"># at 441</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 520 CRC32 0x05a9c5a1  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736093/*!*/;</span><br><span class="line">SET @@session.pseudo_thread_id=1/*!*/;</span><br><span class="line">SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;</span><br><span class="line">SET @@session.sql_mode=1075838976/*!*/;</span><br><span class="line">SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;</span><br><span class="line">/*!\C utf8 *//*!*/;</span><br><span class="line">SET @@session.character_set_client=33,@@session.collation_connection=33,@@session.collation_server=8/*!*/;</span><br><span class="line">SET @@session.lc_time_names=0/*!*/;</span><br><span class="line">SET @@session.collation_database=DEFAULT/*!*/;</span><br><span class="line">BEGIN</span><br><span class="line">/*!*/;</span><br><span class="line"># at 520</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 671 CRC32 0xad9e7dc8  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">use `test`/*!*/;</span><br><span class="line">SET TIMESTAMP=1490736093/*!*/;</span><br><span class="line">insert into student values(1,&apos;malongshuai&apos;,&apos;male&apos;),(2,&apos;gaoxiaofang&apos;,&apos;female&apos;)</span><br><span class="line">/*!*/;</span><br><span class="line"># at 671</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 702 CRC32 0xb69b0f7d  Xid = 32</span><br><span class="line">COMMIT/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line"></span><br><span class="line">...后面固定部分省略...</span><br></pre></td></tr></table></figure>
<blockquote>
<p>使用-d可以只显示指定数据库相关的操作。例如先切换到其他数据库进行一番操作，然后再使用-d查看日志。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use mysql;</span><br><span class="line">mysql&gt; create table mytest(id int);</span><br><span class="line"></span><br><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 -d mysql</span><br><span class="line">...前固定部分省略...&apos;/*!*/;</span><br><span class="line"># at 120</span><br><span class="line"># at 305</span><br><span class="line"># at 441</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 520 CRC32 0x05a9c5a1  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736093/*!*/;</span><br><span class="line">SET @@session.pseudo_thread_id=1/*!*/;</span><br><span class="line">SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;</span><br><span class="line">SET @@session.sql_mode=1075838976/*!*/;</span><br><span class="line">SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;</span><br><span class="line">/*!\C utf8 *//*!*/;</span><br><span class="line">SET @@session.character_set_client=33,@@session.collation_connection=33,@@session.collation_server=8/*!*/;</span><br><span class="line">SET @@session.lc_time_names=0/*!*/;</span><br><span class="line">SET @@session.collation_database=DEFAULT/*!*/;</span><br><span class="line">BEGIN</span><br><span class="line">/*!*/;</span><br><span class="line"># at 520</span><br><span class="line"># at 671</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 702 CRC32 0xb69b0f7d  Xid = 32</span><br><span class="line">COMMIT/*!*/;</span><br><span class="line"># at 702</span><br><span class="line">#170329  6:27:12 server id 1  end_log_pos 805 CRC32 0x491529ff  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">use `mysql`/*!*/;</span><br><span class="line">SET TIMESTAMP=1490740032/*!*/;</span><br><span class="line">create table mytest(id int)</span><br><span class="line">/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line">...后面固定部分省略...</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以看到，除了指定的mysql数据库的信息输出了，还非常简化的输出了其他数据库的信息。  </p>
</blockquote>
<blockquote>
<p>mysqlbinlog最有用的两个选项就是指定时间和位置来输出日志。  </p>
<p>指定时间时，将输出指定时间范围内的日志。指定的时间可以不和日志中记录的日志相同。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 --start-datetime=&apos;2017-03-28 00:00:01&apos; --stop-datetime=&apos;2017-03-29 05:21:23&apos;</span><br><span class="line">...前面固定部分省略...</span><br><span class="line">&apos;/*!*/;</span><br><span class="line"># at 120</span><br><span class="line">#170329  5:20:00 server id 1  end_log_pos 305 CRC32 0xbac43912  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">use `test`/*!*/;</span><br><span class="line">SET TIMESTAMP=1490736000/*!*/;</span><br><span class="line">SET @@session.pseudo_thread_id=1/*!*/;</span><br><span class="line">SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;</span><br><span class="line">SET @@session.sql_mode=1075838976/*!*/;</span><br><span class="line">SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;</span><br><span class="line">/*!\C utf8 *//*!*/;</span><br><span class="line">SET @@session.character_set_client=33,@@session.collation_connection=33,@@session.collation_server=8/*!*/;</span><br><span class="line">SET @@session.lc_time_names=0/*!*/;</span><br><span class="line">SET @@session.collation_database=DEFAULT/*!*/;</span><br><span class="line">create table student(studentid int not null primary key,name varchar(30) not null,gender enum(&apos;female&apos;,&apos;mail&apos;))</span><br><span class="line">/*!*/;</span><br><span class="line"># at 305</span><br><span class="line">#170329  5:21:21 server id 1  end_log_pos 441 CRC32 0xde67f702  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736081/*!*/;</span><br><span class="line">alter table student change gender gender enum(&apos;female&apos;,&apos;male&apos;)</span><br><span class="line">/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line">...后面固定部分省略...</span><br></pre></td></tr></table></figure>
<blockquote>
<p>同理指定位置也一样，但是指定位置时有个要求是如果指定起始位置，则必须指定日志文件中明确的起始位置。例如，日志文件中有位置120、305、441，可以指定起始和结束位置为120、500，但是不可以指定起止位置为150、500，因为日志文件中不存在150这个位置。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 --start-position=150 --stop-position=441</span><br><span class="line">...前面固定部分省略...</span><br><span class="line">&apos;/*!*/;</span><br><span class="line">ERROR: Error in Log_event::read_log_event(): &apos;read error&apos;, data_len: 4202496, event_type: 0</span><br><span class="line">...后面固定部分省略... </span><br><span class="line"></span><br><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000001 --start-position=305 --stop-position=500</span><br><span class="line">...前面固定部分省略... </span><br><span class="line">&apos;/*!*/;</span><br><span class="line"># at 305</span><br><span class="line">#170329  5:21:21 server id 1  end_log_pos 441 CRC32 0xde67f702  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">use `test`/*!*/;</span><br><span class="line">SET TIMESTAMP=1490736081/*!*/;</span><br><span class="line">SET @@session.pseudo_thread_id=1/*!*/;</span><br><span class="line">SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;</span><br><span class="line">SET @@session.sql_mode=1075838976/*!*/;</span><br><span class="line">SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;</span><br><span class="line">/*!\C utf8 *//*!*/;</span><br><span class="line">SET @@session.character_set_client=33,@@session.collation_connection=33,@@session.collation_server=8/*!*/;</span><br><span class="line">SET @@session.lc_time_names=0/*!*/;</span><br><span class="line">SET @@session.collation_database=DEFAULT/*!*/;</span><br><span class="line">alter table student change gender gender enum(&apos;female&apos;,&apos;male&apos;)</span><br><span class="line">/*!*/;</span><br><span class="line"># at 441</span><br><span class="line">#170329  5:21:33 server id 1  end_log_pos 520 CRC32 0x05a9c5a1  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490736093/*!*/;</span><br><span class="line">BEGIN</span><br><span class="line">/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line">...后面固定部分省略...</span><br></pre></td></tr></table></figure>
<h6 id="show-binary-logs"><a href="#show-binary-logs" class="headerlink" title="show binary logs"></a>show binary logs</h6><blockquote>
<p>该语句用于查看当前使用了哪些二进制日志文件。  </p>
<p>可以通过查看二进制的index文件来查看当前正在使用哪些二进制日志。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# cat mysql-bin.index </span><br><span class="line">./mysql-bin.000003</span><br><span class="line">./mysql-bin.000004</span><br><span class="line">./mysql-bin.000005</span><br><span class="line">./mysql-bin.000006</span><br></pre></td></tr></table></figure>
<blockquote>
<p>也可以在mysql环境中使用 show {binary | master} logs 来查看。binary和master是同义词。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show binary logs;</span><br><span class="line">+------------------+-----------+</span><br><span class="line">| Log_name         | File_size |</span><br><span class="line">+------------------+-----------+</span><br><span class="line">| mysql-bin.000003 |       167 |</span><br><span class="line">| mysql-bin.000004 |       785 |</span><br><span class="line">| mysql-bin.000005 |      1153 |</span><br><span class="line">| mysql-bin.000006 |       602 |</span><br><span class="line">+------------------+-----------</span><br></pre></td></tr></table></figure>
<h6 id="show-binlog-events"><a href="#show-binlog-events" class="headerlink" title="show binlog events"></a>show binlog events</h6><blockquote>
<p>该语句用于查看日志中进行了哪些操作。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show binlog events in &apos;mysql-bin.000005&apos;;</span><br></pre></td></tr></table></figure>
<p><img src="https://images2018.cnblogs.com/blog/733013/201805/733013-20180507091129596-1182363918.png" alt="image"></p>
<h6 id="可以指定起始位置。同样，起始位置必须指定正确，不能指定不存在的位置。"><a href="#可以指定起始位置。同样，起始位置必须指定正确，不能指定不存在的位置。" class="headerlink" title="可以指定起始位置。同样，起始位置必须指定正确，不能指定不存在的位置。"></a>可以指定起始位置。同样，起始位置必须指定正确，不能指定不存在的位置。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show binlog events in &apos;mysql-bin.000005&apos; from 961;</span><br><span class="line">+------------------+------+------------+-----------+-------------+--------------------------------+</span><br><span class="line">| Log_name         | Pos  | Event_type | Server_id | End_log_pos | Info                           |</span><br><span class="line">+------------------+------+------------+-----------+-------------+--------------------------------+</span><br><span class="line">| mysql-bin.000005 |  961 | Table_map  |         1 |        1019 | table_id: 98 (test.student)    |</span><br><span class="line">| mysql-bin.000005 | 1019 | Write_rows |         1 |        1075 | table_id: 98 flags: STMT_END_F |</span><br><span class="line">| mysql-bin.000005 | 1075 | Xid        |         1 |        1106 | COMMIT /* xid=129 */           |</span><br><span class="line">| mysql-bin.000005 | 1106 | Rotate     |         1 |        1153 | mysql-bin.000006;pos=4         |</span><br><span class="line">+------------------+------+------------+-----------+-------------+--------------------------------+</span><br></pre></td></tr></table></figure>
<h6 id="show-master-status"><a href="#show-master-status" class="headerlink" title="show master status"></a>show master status</h6><blockquote>
<p>该语句用于显示主服务器中的二进制日志信息。如果是主从结构，它只会显示主从结构中主服务器的二进制日志信息。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status;    </span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br><span class="line">| mysql-bin.000006 |      602 |              |                  |                   |</span><br><span class="line">+------------------+----------+--------------+------------------+-------------------+</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以查看到当前正在使用的日志及下一事件记录的开始位置，还能查看到哪些数据库需要记录二进制日志，哪些数据库不记录二进制日志。  </p>
</blockquote>
<h5 id="删除二进制日志"><a href="#删除二进制日志" class="headerlink" title="删除二进制日志"></a>删除二进制日志</h5><h6 id="删除二进制日志有几种方法。不管哪种方法，都会将删除后的信息同步到二进制index文件中。"><a href="#删除二进制日志有几种方法。不管哪种方法，都会将删除后的信息同步到二进制index文件中。" class="headerlink" title="删除二进制日志有几种方法。不管哪种方法，都会将删除后的信息同步到二进制index文件中。"></a>删除二进制日志有几种方法。不管哪种方法，都会将删除后的信息同步到二进制index文件中。</h6><h6 id="reset-master将会删除所有日志，并让日志文件重新从000001开始。"><a href="#reset-master将会删除所有日志，并让日志文件重新从000001开始。" class="headerlink" title="reset master将会删除所有日志，并让日志文件重新从000001开始。"></a>reset master将会删除所有日志，并让日志文件重新从000001开始。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; reset master;</span><br></pre></td></tr></table></figure>
<h6 id="PURGE-BINARY-MASTER-LOGS-TO-‘log-name’-BEFORE-datetime-expr"><a href="#PURGE-BINARY-MASTER-LOGS-TO-‘log-name’-BEFORE-datetime-expr" class="headerlink" title="PURGE { BINARY | MASTER } LOGS { TO ‘log_name’ | BEFORE datetime_expr }"></a>PURGE { BINARY | MASTER } LOGS { TO ‘log_name’ | BEFORE datetime_expr }</h6><blockquote>
<p>purge master logs to “binlog_name.00000X” 将会清空00000X之前的所有日志文件。例如删除000006之前的日志文件。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; purge master logs to &quot;mysql-bin.000006&quot;;</span><br><span class="line">mysql&gt; purge binary logs to &quot;mysql-bin.000006&quot;;</span><br></pre></td></tr></table></figure>
<h6 id="master和binary是同义词"><a href="#master和binary是同义词" class="headerlink" title="master和binary是同义词"></a>master和binary是同义词</h6><blockquote>
<p> purge master logs before ‘yyyy-mm-dd hh:mi:ss’ 将会删除指定日期之前的所有日志。但是若指定的时间处在正在使用中的日志文件中，将无法进行purge。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; purge master logs before &apos;2017-03-29 07:36:40&apos;;</span><br><span class="line"></span><br><span class="line">mysql&gt; show warnings;</span><br><span class="line">+---------+------+---------------------------------------------------------------------------+</span><br><span class="line">| Level   | Code | Message                                                                   |</span><br><span class="line">+---------+------+---------------------------------------------------------------------------+</span><br><span class="line">| Warning | 1868 | file ./mysql-bin.000003 was not purged because it is the active log file. |</span><br><span class="line">+---------+------+---------------------------------------------------------------------------+</span><br></pre></td></tr></table></figure>
<h6 id="使用–expire-logs-days-N选项指定过了多少天日志自动过期清空。"><a href="#使用–expire-logs-days-N选项指定过了多少天日志自动过期清空。" class="headerlink" title="使用–expire_logs_days=N选项指定过了多少天日志自动过期清空。"></a>使用–expire_logs_days=N选项指定过了多少天日志自动过期清空。</h6><h5 id="二进制日志的记录格式"><a href="#二进制日志的记录格式" class="headerlink" title="二进制日志的记录格式"></a>二进制日志的记录格式</h5><blockquote>
<p>在MySQL 5.1之前，MySQL只有一种基于语句statement形式的日志记录格式。即将所有的相关操作记录为SQL语句形式。但是这样的记录方式对某些特殊信息无法同步记录，例如uuid，now()等这样动态变化的值。  </p>
</blockquote>
<blockquote>
<p>从MySQL 5.1开始，MySQL支持statement、row、mixed三种形式的记录方式。row形式是基于行来记录，也就是将相关行的每一列的值都在日志中保存下来，这样的结果会导致日志文件变得非常大，但是保证了动态值的确定性。还有一种mixed形式，表示如何记录日志由MySQL自己来决定。  </p>
</blockquote>
<blockquote>
<p>日志的记录格式由变量 binlog_format 来指定。其值有：row,statement,mixed。innodb引擎的创始人之一在博客上推荐使用row格式。  </p>
</blockquote>
<h6 id="下面将记录格式改为row。"><a href="#下面将记录格式改为row。" class="headerlink" title="下面将记录格式改为row。"></a>下面将记录格式改为row。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; alter table student add birthday datetime default  now();</span><br><span class="line">mysql&gt; flush logs;</span><br><span class="line">mysql&gt; set binlog_format=&apos;row&apos;;</span><br><span class="line">mysql&gt; insert into student values(7,&apos;xiaowoniu&apos;,&apos;female&apos;,now());</span><br></pre></td></tr></table></figure>
<h6 id="查看产生的日志。"><a href="#查看产生的日志。" class="headerlink" title="查看产生的日志。"></a>查看产生的日志。</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000005</span><br><span class="line">...前面固定部分省略...</span><br><span class="line">&apos;/*!*/;</span><br><span class="line"># at 120</span><br><span class="line">#170329  8:06:24 server id 1  end_log_pos 200 CRC32 0x0ac02649  Query   thread_id=1     exec_time=0     error_code=0</span><br><span class="line">SET TIMESTAMP=1490745984/*!*/;</span><br><span class="line">SET @@session.pseudo_thread_id=1/*!*/;</span><br><span class="line">SET @@session.foreign_key_checks=1, @@session.sql_auto_is_null=0, @@session.unique_checks=1, @@session.autocommit=1/*!*/;</span><br><span class="line">SET @@session.sql_mode=1075838976/*!*/;</span><br><span class="line">SET @@session.auto_increment_increment=1, @@session.auto_increment_offset=1/*!*/;</span><br><span class="line">/*!\C utf8 *//*!*/;</span><br><span class="line">SET @@session.character_set_client=33,@@session.collation_connection=33,@@session.collation_server=8/*!*/;</span><br><span class="line">SET @@session.time_zone=&apos;SYSTEM&apos;/*!*/;</span><br><span class="line">SET @@session.lc_time_names=0/*!*/;</span><br><span class="line">SET @@session.collation_database=DEFAULT/*!*/;</span><br><span class="line">BEGIN</span><br><span class="line">/*!*/;</span><br><span class="line"># at 200</span><br><span class="line">#170329  8:06:24 server id 1  end_log_pos 258 CRC32 0xb8cdfd09  Table_map: `test`.`student` mapped to number 94</span><br><span class="line"># at 258</span><br><span class="line">#170329  8:06:24 server id 1  end_log_pos 314 CRC32 0x8ce6f72c  Write_rows: table id 94 flags: STMT_END_F</span><br><span class="line"></span><br><span class="line">BINLOG &apos;</span><br><span class="line">gPraWBMBAAAAOgAAAAIBAAAAAF4AAAAAAAEABHRlc3QAB3N0dWRlbnQABAMP/hIFHgD3AQAMCf3N</span><br><span class="line">uA==</span><br><span class="line">gPraWB4BAAAAOAAAADoBAAAAAF4AAAAAAAEAAgAE//AHAAAACXhpYW93b25pdQGZnDqBmCz35ow=</span><br><span class="line">&apos;/*!*/;</span><br><span class="line"># at 314</span><br><span class="line">#170329  8:06:24 server id 1  end_log_pos 345 CRC32 0x7a48c057  Xid = 114</span><br><span class="line">COMMIT/*!*/;</span><br><span class="line">DELIMITER ;</span><br><span class="line">...后面固定部分省略...</span><br></pre></td></tr></table></figure>
<blockquote>
<p>发现是一堆看不懂的东西，使用-vv可将这些显示出来。可以看出，结果中记录的非常详细，这也是为什么基于row记录日志会导致日志文件极速变大。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@xuexi data]# mysqlbinlog mysql-bin.000005 -vv</span><br><span class="line">...前面省略...</span><br><span class="line">BINLOG &apos;</span><br><span class="line">gPraWBMBAAAAOgAAAAIBAAAAAF4AAAAAAAEABHRlc3QAB3N0dWRlbnQABAMP/hIFHgD3AQAMCf3N</span><br><span class="line">uA==</span><br><span class="line">gPraWB4BAAAAOAAAADoBAAAAAF4AAAAAAAEAAgAE//AHAAAACXhpYW93b25pdQGZnDqBmCz35ow=</span><br><span class="line">&apos;/*!*/;</span><br><span class="line">### INSERT INTO `test`.`student`</span><br><span class="line">### SET</span><br><span class="line">###   @1=7 /* INT meta=0 nullable=0 is_null=0 */</span><br><span class="line">###   @2=&apos;xiaowoniu&apos; /* VARSTRING(30) meta=30 nullable=0 is_null=0 */</span><br><span class="line">###   @3=1 /* ENUM(1 byte) meta=63233 nullable=1 is_null=0 */</span><br><span class="line">###   @4=&apos;2017-03-29 08:06:24&apos; /* DATETIME(0) meta=0 nullable=1 is_null=0 */</span><br><span class="line"># at 314</span><br><span class="line">...后面省略...</span><br></pre></td></tr></table></figure>
<h6 id="还有一种mixed模式。这种模式下默认会采用statement的方式记录，只有以下几种情况会采用row的形式来记录日志。"><a href="#还有一种mixed模式。这种模式下默认会采用statement的方式记录，只有以下几种情况会采用row的形式来记录日志。" class="headerlink" title="还有一种mixed模式。这种模式下默认会采用statement的方式记录，只有以下几种情况会采用row的形式来记录日志。"></a>还有一种mixed模式。这种模式下默认会采用statement的方式记录，只有以下几种情况会采用row的形式来记录日志。</h6><blockquote>
<p>1.表的存储引擎为NDB，这时对表的DML操作都会以row的格式记录。  </p>
<p>2.使用了uuid()、user()、current_user()、found_rows()、row_count()等不确定函数。但测试发现对now()函数仍会以statement格式记录，而sysdate()函数会以row格式记录。  </p>
<p>3.使用了insert delay语句。  </p>
<p>4.使用了临时表。  </p>
</blockquote>
<h5 id="二进制日志相关的变量"><a href="#二进制日志相关的变量" class="headerlink" title="二进制日志相关的变量"></a>二进制日志相关的变量</h5><h6 id="注意：在配置binlog相关变量的时候，相关变量名总是搞混，因为有的是binlog，有的是log-bin，当他们分开的时候，log在前，当它们一起的时候，bin在前。在配置文件中也同样如此。"><a href="#注意：在配置binlog相关变量的时候，相关变量名总是搞混，因为有的是binlog，有的是log-bin，当他们分开的时候，log在前，当它们一起的时候，bin在前。在配置文件中也同样如此。" class="headerlink" title="注意：在配置binlog相关变量的时候，相关变量名总是搞混，因为有的是binlog，有的是log_bin，当他们分开的时候，log在前，当它们一起的时候，bin在前。在配置文件中也同样如此。"></a>注意：在配置binlog相关变量的时候，相关变量名总是搞混，因为有的是binlog，有的是log_bin，当他们分开的时候，log在前，当它们一起的时候，bin在前。在配置文件中也同样如此。</h6><blockquote>
<p>log_bin = {on | off | base_name} #指定是否启用记录二进制日志或者指定一个日志路径(路径不能加.否则.后的被忽略)  </p>
</blockquote>
<blockquote>
<p>sql_log_bin ={ on | off } #指定是否启用记录二进制日志，只有在log_bin开启的时候才有效  </p>
</blockquote>
<blockquote>
<p>expire_logs_days = #指定自动删除二进制日志的时间，即日志过期时间  </p>
</blockquote>
<blockquote>
<p>binlog_do_db = #明确指定要记录日志的数据库  </p>
</blockquote>
<blockquote>
<p>binlog_ignore_db = #指定不记录二进制日志的数据库  </p>
</blockquote>
<blockquote>
<p>log_bin_index = #指定mysql-bin.index文件的路径  </p>
</blockquote>
<blockquote>
<p>binlog_format = { mixed | row | statement } #指定二进制日志基于什么模式记录  </p>
</blockquote>
<blockquote>
<p>binlog_rows_query_log_events = { 1|0 } # MySQL5.6.2添加了该变量，当binlog format为row时，默认不会记录row对应的SQL语句，设置为1或其他true布尔值时会记录，但需要使用mysqlbinlog -v查看，这些语句是被注释的，恢复时不会被执行。  </p>
</blockquote>
<blockquote>
<p>max_binlog_size = #指定二进制日志文件最大值，超出指定值将自动滚动。但由于事务不会跨文件，所以并不一定总是精确。  </p>
</blockquote>
<blockquote>
<p>binlog_cache_size = 32768 #基于事务类型的日志会先记录在缓冲区，当达到该缓冲大小时这些日志会写入磁盘  </p>
</blockquote>
<blockquote>
<p>max_binlog_cache_size = #指定二进制日志缓存最大大小，硬限制。默认4G，够大了，建议不要改  </p>
</blockquote>
<blockquote>
<p>binlog_cache_use：使用缓存写二进制日志的次数(这是一个实时变化的统计值)  </p>
</blockquote>
<blockquote>
<p>binlog_cache_disk_use:使用临时文件写二进制日志的次数，当日志超过了binlog_cache_size的时候会使用临时文件写日志，如果该变量值不为0，则考虑增大binlog_cache_size的值  </p>
</blockquote>
<blockquote>
<p>binlog_stmt_cache_size = 32768 #一般等同于且决定binlog_cache_size大小，所以修改缓存大小时只需修改这个而不用修改binlog_cache_size  </p>
</blockquote>
<blockquote>
<p>binlog_stmt_cache_use：使用缓存写二进制日志的次数  </p>
</blockquote>
<blockquote>
<p>binlog_stmt_cache_disk_use: 使用临时文件写二进制日志的次数，当日志超过了binlog_cache_size的时候会使用临时文件写日志，如果该变量值不为0，则考虑增大binlog_cache_size的值  </p>
</blockquote>
<blockquote>
<p>sync_binlog = { 0 | n } #这个参数直接影响mysql的性能和完整性<br>sync_binlog=0:不同步，日志何时刷到磁盘由FileSystem决定，这个性能最好。<br>sync_binlog=n:每写n次二进制日志事件(不是事务)，MySQL将执行一次磁盘同步指令fdatasync()将缓存日志刷新到磁盘日志文件中。Mysql中默认的设置是sync_binlog=0，即不同步，这时性能最好，但风险最大。一旦系统奔溃，缓存中的日志都会丢失。  </p>
</blockquote>
<h6 id="在innodb的主从复制结构中，如果启用了二进制日志-几乎都会启用-，要保证事务的一致性和持久性的时候，必须将sync-binlog的值设置为1，因为每次事务提交都会写入二进制日志，设置为1就保证了每次事务提交时二进制日志都会写入到磁盘中，从而立即被从服务器复制过去。"><a href="#在innodb的主从复制结构中，如果启用了二进制日志-几乎都会启用-，要保证事务的一致性和持久性的时候，必须将sync-binlog的值设置为1，因为每次事务提交都会写入二进制日志，设置为1就保证了每次事务提交时二进制日志都会写入到磁盘中，从而立即被从服务器复制过去。" class="headerlink" title="在innodb的主从复制结构中，如果启用了二进制日志(几乎都会启用)，要保证事务的一致性和持久性的时候，必须将sync_binlog的值设置为1，因为每次事务提交都会写入二进制日志，设置为1就保证了每次事务提交时二进制日志都会写入到磁盘中，从而立即被从服务器复制过去。"></a>在innodb的主从复制结构中，如果启用了二进制日志(几乎都会启用)，要保证事务的一致性和持久性的时候，必须将sync_binlog的值设置为1，因为每次事务提交都会写入二进制日志，设置为1就保证了每次事务提交时二进制日志都会写入到磁盘中，从而立即被从服务器复制过去。</h6><h5 id="二进制日志定点还原数据库"><a href="#二进制日志定点还原数据库" class="headerlink" title="二进制日志定点还原数据库"></a>二进制日志定点还原数据库</h5><blockquote>
<p>只需指定二进制日志的起始位置（可指定终止位置）并将其保存到sql文件中，由mysql命令来载入恢复即可。当然直接通过管道送给mysql命令也可。  </p>
</blockquote>
<blockquote>
<p>至于是基于位置来恢复还是基于时间点来恢复，这两种行为都可以。选择时间点来恢复比较直观些，并且跨日志文件恢复时更方便。  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqlbinlog --stop-datetime=&quot;2014-7-2 15:27:48&quot; /tmp/mysql-bin.000008 | mysql -u user -p password</span><br></pre></td></tr></table></figure>
<blockquote>
<p>恢复多个二进制日志文件时：  </p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqlbinlog mysql-bin.[*] | mysql -uroot -p password</span><br></pre></td></tr></table></figure>
<blockquote>
<p>或者将它们导入到一个文件中后恢复。</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysqlbinlog mysql-bin.000001 &gt; /tmp/a.sql</span><br><span class="line">mysqlbinlog mysql-bin.000002 &gt;&gt;/tmp/a.sql</span><br><span class="line">mysql -u root -p password -e &quot;source /tmp/a.sql&quot;</span><br></pre></td></tr></table></figure>

    </article>
    <!-- license  -->
    
        <div class="license-wrapper">
            <p>原文作者: <a href="http://yoursite.com">John Doe</a>
            <p>原文链接: <a href="http://yoursite.com/2017/05/22/MYSQL 数据库的日志介绍/">http://yoursite.com/2017/05/22/MYSQL 数据库的日志介绍/</a>
            <p>发表日期: <a href="http://yoursite.com/2017/05/22/MYSQL 数据库的日志介绍/">May 22nd 2017, 12:00:00 am</a>
            <p>版权声明: 本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可</p>
        </div>
    
    <!-- paginator  -->
    <ul class="post-paginator">
        <li class="next">
            
                <div class="nextSlogan">Next Post</div>
                <a href= "/2017/06/01/介绍 MYSQL的事务日志/" title= 介绍 MYSQL的事务日志 >
                    <div class="nextTitle">介绍 MYSQL的事务日志</div>
                </a>
            
        </li>
        <li class="previous">
            
                <div class="prevSlogan">Previous Post</div>
                <a href= "/2017/05/15/MYSQL MariaDB 的事务和事务隔离级别/" title= MYSQL MariaDB 的事务和事务隔离级别 >
                    <div class="prevTitle">MYSQL MariaDB 的事务和事务隔离级别</div>
                </a>
            
        </li>
    </ul>
    <!-- 评论插件 -->
    <!-- 来必力City版安装代码 -->

<!-- City版安装代码已完成 -->
    
    
    <!--PC和WAP自适应版-->

    <!--PC版-->


    
    

    <!-- 评论 -->
</main>
            <!-- profile -->
            
        </div>
        <footer class="footer footer-unloaded">
    <!-- social  -->
    
    <div class="social">
        
    
        
            
                <a href="mailto:1020846215@qq.com" class="iconfont-archer email" title=email ></a>
            
        
    
        
            
                <a href="//github.com/fi3ework" class="iconfont-archer github" target="_blank" title=github></a>
            
        
    
        
            
                <span class="iconfont-archer wechat" title=wechat>
                  
                  <img class="profile-qr" src="/assets/example_qr.png" />
                </span>
            
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    
        
    

    </div>
    
    <!-- powered by Hexo  -->
    <div class="copyright">
        <span id="hexo-power">Powered by <a href="https://hexo.io/" target="_blank">Hexo</a></span><span class="iconfont-archer power">&#xe635;</span><span id="theme-info">theme <a href="https://github.com/fi3ework/hexo-theme-archer" target="_blank">Archer</a></span>
    </div>
    <!-- 不蒜子  -->
    
    <div class="busuanzi-container">
    
     
    <span id="busuanzi_container_site_pv">PV: <span id="busuanzi_value_site_pv"></span> :)</span>
    
    </div>
    
</footer>
    </div>
    <!-- toc -->
    
    <div class="toc-wrapper" style=
    







top:50vh;

    >
        <div class="toc-catalog">
            <span class="iconfont-archer catalog-icon">&#xe613;</span><span>CATALOG</span>
        </div>
        <ol class="toc"><li class="toc-item toc-level-4"><a class="toc-link" href="#日志刷新操作"><span class="toc-number">1.</span> <span class="toc-text">日志刷新操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#错误日志"><span class="toc-number">2.</span> <span class="toc-text">错误日志</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#如果不知道错误日志的位置，可以查看变量log-error来查看。"><span class="toc-number">2.0.1.</span> <span class="toc-text">如果不知道错误日志的位置，可以查看变量log_error来查看。</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#一般查询日志"><span class="toc-number">3.</span> <span class="toc-text">一般查询日志</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#和一般查询日志相关的变量有："><span class="toc-number">3.0.1.</span> <span class="toc-text">和一般查询日志相关的变量有：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#执行几个语句。"><span class="toc-number">3.0.2.</span> <span class="toc-text">执行几个语句。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#查看一般查询日志的内容。"><span class="toc-number">3.0.3.</span> <span class="toc-text">查看一般查询日志的内容。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#由此可知，一般查询日志查询的不止是select语句，几乎所有的语句都会记录。"><span class="toc-number">3.0.4.</span> <span class="toc-text">由此可知，一般查询日志查询的不止是select语句，几乎所有的语句都会记录。</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#慢查询日志"><span class="toc-number">4.</span> <span class="toc-text">慢查询日志</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#和慢查询有关的变量："><span class="toc-number">4.0.1.</span> <span class="toc-text">和慢查询有关的变量：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#慢查询在SQL语句调优的时候非常有用，应该将它启用起来。"><span class="toc-number">4.0.2.</span> <span class="toc-text">慢查询在SQL语句调优的时候非常有用，应该将它启用起来。</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#二进制日志"><span class="toc-number">5.</span> <span class="toc-text">二进制日志</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#二进制日志文件"><span class="toc-number">5.1.</span> <span class="toc-text">二进制日志文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#查看二进制日志"><span class="toc-number">5.2.</span> <span class="toc-text">查看二进制日志</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#mysqlbinlog"><span class="toc-number">5.2.1.</span> <span class="toc-text">mysqlbinlog</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#现在在数据库中执行下面的操作："><span class="toc-number">5.2.2.</span> <span class="toc-text">现在在数据库中执行下面的操作：</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#再查看二进制日志信息。"><span class="toc-number">5.2.3.</span> <span class="toc-text">再查看二进制日志信息。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#show-binary-logs"><span class="toc-number">5.2.4.</span> <span class="toc-text">show binary logs</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#show-binlog-events"><span class="toc-number">5.2.5.</span> <span class="toc-text">show binlog events</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#可以指定起始位置。同样，起始位置必须指定正确，不能指定不存在的位置。"><span class="toc-number">5.2.6.</span> <span class="toc-text">可以指定起始位置。同样，起始位置必须指定正确，不能指定不存在的位置。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#show-master-status"><span class="toc-number">5.2.7.</span> <span class="toc-text">show master status</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#删除二进制日志"><span class="toc-number">5.3.</span> <span class="toc-text">删除二进制日志</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#删除二进制日志有几种方法。不管哪种方法，都会将删除后的信息同步到二进制index文件中。"><span class="toc-number">5.3.1.</span> <span class="toc-text">删除二进制日志有几种方法。不管哪种方法，都会将删除后的信息同步到二进制index文件中。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#reset-master将会删除所有日志，并让日志文件重新从000001开始。"><span class="toc-number">5.3.2.</span> <span class="toc-text">reset master将会删除所有日志，并让日志文件重新从000001开始。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#PURGE-BINARY-MASTER-LOGS-TO-‘log-name’-BEFORE-datetime-expr"><span class="toc-number">5.3.3.</span> <span class="toc-text">PURGE { BINARY | MASTER } LOGS { TO ‘log_name’ | BEFORE datetime_expr }</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#master和binary是同义词"><span class="toc-number">5.3.4.</span> <span class="toc-text">master和binary是同义词</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#使用–expire-logs-days-N选项指定过了多少天日志自动过期清空。"><span class="toc-number">5.3.5.</span> <span class="toc-text">使用–expire_logs_days=N选项指定过了多少天日志自动过期清空。</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#二进制日志的记录格式"><span class="toc-number">5.4.</span> <span class="toc-text">二进制日志的记录格式</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#下面将记录格式改为row。"><span class="toc-number">5.4.1.</span> <span class="toc-text">下面将记录格式改为row。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#查看产生的日志。"><span class="toc-number">5.4.2.</span> <span class="toc-text">查看产生的日志。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#还有一种mixed模式。这种模式下默认会采用statement的方式记录，只有以下几种情况会采用row的形式来记录日志。"><span class="toc-number">5.4.3.</span> <span class="toc-text">还有一种mixed模式。这种模式下默认会采用statement的方式记录，只有以下几种情况会采用row的形式来记录日志。</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#二进制日志相关的变量"><span class="toc-number">5.5.</span> <span class="toc-text">二进制日志相关的变量</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#注意：在配置binlog相关变量的时候，相关变量名总是搞混，因为有的是binlog，有的是log-bin，当他们分开的时候，log在前，当它们一起的时候，bin在前。在配置文件中也同样如此。"><span class="toc-number">5.5.1.</span> <span class="toc-text">注意：在配置binlog相关变量的时候，相关变量名总是搞混，因为有的是binlog，有的是log_bin，当他们分开的时候，log在前，当它们一起的时候，bin在前。在配置文件中也同样如此。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#在innodb的主从复制结构中，如果启用了二进制日志-几乎都会启用-，要保证事务的一致性和持久性的时候，必须将sync-binlog的值设置为1，因为每次事务提交都会写入二进制日志，设置为1就保证了每次事务提交时二进制日志都会写入到磁盘中，从而立即被从服务器复制过去。"><span class="toc-number">5.5.2.</span> <span class="toc-text">在innodb的主从复制结构中，如果启用了二进制日志(几乎都会启用)，要保证事务的一致性和持久性的时候，必须将sync_binlog的值设置为1，因为每次事务提交都会写入二进制日志，设置为1就保证了每次事务提交时二进制日志都会写入到磁盘中，从而立即被从服务器复制过去。</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#二进制日志定点还原数据库"><span class="toc-number">5.6.</span> <span class="toc-text">二进制日志定点还原数据库</span></a></li></ol></li></ol>
    </div>
    
    <div class="back-top iconfont-archer">&#xe639;</div>
    <div class="sidebar sidebar-hide">
    <ul class="sidebar-tabs sidebar-tabs-active-0">
        <li class="sidebar-tab-archives"><span class="iconfont-archer">&#xe67d;</span><span class="tab-name">Archive</span></li>
        <li class="sidebar-tab-tags"><span class="iconfont-archer">&#xe61b;</span><span class="tab-name">Tag</span></li>
        <li class="sidebar-tab-categories"><span class="iconfont-archer">&#xe666;</span><span class="tab-name">Cate</span></li>
    </ul>
    <div class="sidebar-content sidebar-content-show-archive">
          <div class="sidebar-panel-archives">
    <!-- 在ejs中将archive按照时间排序 -->
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <div class="total-and-search">
        <div class="total-archive">
        Total : 39
        </div>
        <!-- search  -->
        
    </div>
    
    <div class="post-archive">
    
    
    
    
    <div class="archive-year"> 2018 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/09</span><a class="archive-post-title" href= "/2018/08/09/Linux 防火墙各种规则实战应用/" >[Untitled Post]</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/09</span><a class="archive-post-title" href= "/2018/08/09/Nginx 详细介绍/" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2017 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/15</span><a class="archive-post-title" href= "/2017/10/15/memcache  缓存原理介绍/" >memcache  缓存原理介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/08</span><a class="archive-post-title" href= "/2017/10/08/tomcat 各种架构实验演示/" >tomcat 各种架构实验演示</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">10/05</span><a class="archive-post-title" href= "/2017/10/05/浅谈 tomcat 原理/" >浅谈 tomcat 原理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/25</span><a class="archive-post-title" href= "/2017/09/25/Varnish 缓存服务器介绍/" >Varnish 缓存服务器介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">09/14</span><a class="archive-post-title" href= "/2017/09/14/keepalived 各种高可用实战演练/" >keepalived 各种高可用实战演练</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/28</span><a class="archive-post-title" href= "/2017/08/28/HAproxy 原理介绍/" >HAproxy 原理介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">08/19</span><a class="archive-post-title" href= "/2017/08/19/lvs 详细介绍/" >lvs 详细介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/24</span><a class="archive-post-title" href= "/2017/06/24/各种网络共享服务实验演示/" >各种网络共享服务实验演示</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/20</span><a class="archive-post-title" href= "/2017/06/20/网络文件共享服务：FTP    NFS   SAMBA/" >网络文件共享服务：FTP    NFS   SAMBA</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/11</span><a class="archive-post-title" href= "/2017/06/11/LAMP 架构的各种演示/" >LAMP 架构的各种演示</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">06/01</span><a class="archive-post-title" href= "/2017/06/01/介绍 MYSQL的事务日志/" >介绍 MYSQL的事务日志</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/22</span><a class="archive-post-title" href= "/2017/05/22/MYSQL 数据库的日志介绍/" >MYSQL 数据库的日志介绍</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/15</span><a class="archive-post-title" href= "/2017/05/15/MYSQL MariaDB 的事务和事务隔离级别/" >MYSQL MariaDB 的事务和事务隔离级别</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">05/08</span><a class="archive-post-title" href= "/2017/05/08/MASQL MariaDB 用户权限管理/" >MASQL MariaDB 用户权限管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/20</span><a class="archive-post-title" href= "/2017/04/20/ext 文件系统机制原理/" >ext 文件系统机制原理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/15</span><a class="archive-post-title" href= "/2017/04/15/Linux分区信息与管理文件系统/" >Linux分区信息与管理文件系统</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/10</span><a class="archive-post-title" href= "/2017/04/10/DHCP 服务/" >DHCP服务</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">04/01</span><a class="archive-post-title" href= "/2017/04/01/Linux系统中su 和 sudo 的用法/" >Linux系统中su 和 sudo 的用法</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/22</span><a class="archive-post-title" href= "/2017/03/22/实现DNS服务主从复制/" >实现DNS服务主从复制</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/20</span><a class="archive-post-title" href= "/2017/03/20/搭建DNS互联网架构服务器(一）/" >搭建DNS互联网架构服务器</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/15</span><a class="archive-post-title" href= "/2017/03/15/搭建DNS 服务，实现主服务器，邮件服务器，泛域名解析，反向解析等/" >搭建DNS 服务，实现主服务器，邮件服务器，泛域名解析，反向解析等</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/12</span><a class="archive-post-title" href= "/2017/03/12/Linux 文件权限管理/" >Linux 文件权限管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">03/08</span><a class="archive-post-title" href= "/2017/03/08/LINUX系统中用户、组管理/" >安装管理包：LINUX系统中用户、组管理</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/28</span><a class="archive-post-title" href= "/2017/02/28/搭建DNS服务器，实现主DNS服务器，负责解析一个域/" >搭建DNS服务器，实现主DNS服务器，负责解析一个域</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/15</span><a class="archive-post-title" href= "/2017/02/15/DNS 服务从基础到深入/" >DNS 服务从基础到深入</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/10</span><a class="archive-post-title" href= "/2017/02/10/SSH端口转发实验/" >SSH端口转发实验</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/08</span><a class="archive-post-title" href= "/2017/02/08/实现PXE自动安装/" >实现PXE自动安装</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">02/01</span><a class="archive-post-title" href= "/2017/02/01/rpm管理包 和 yum管理包(1)/" >安装管理包：rpm包和yum包</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/20</span><a class="archive-post-title" href= "/2017/01/20/搭建CA/" >如何搭建CA（向CA申请证书）</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">01/08</span><a class="archive-post-title" href= "/2017/01/08/自制一个mini 的Linux系统/" >自制一个mini 的Linux系统</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2016 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/20</span><a class="archive-post-title" href= "/2016/12/20/进程管理和计划任务的知识点()/" >进程管理与计划任务的知识点</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/15</span><a class="archive-post-title" href= "/2016/12/15/文本处理工具：sed/" >文本处理工具：sed</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">12/08</span><a class="archive-post-title" href= "/2016/12/08/TCP、IP协议三次握手与四次握手流程解析（）/" >TCP、IP协议三次握手与四次握手流程解析</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/2018/08/09/Nginx 各种实验演示/" >[Untitled Post]</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> 2016 </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/29</span><a class="archive-post-title" href= "/2016/11/29/Linux 的一些基础练习题/" >Linux 的一些基础练习题</a>
        </li>
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">11/23</span><a class="archive-post-title" href= "/2016/11/23/对正则表达式，VIM编辑器命令的基本操作（三）/" >对正则表达式，VIM编辑器命令的基本操作</a>
        </li>
    
    
    
    
    
        </ul>
    
    <div class="archive-year"> Invalid date </div>
    <ul class="year-list">
    
    
        <li class="archive-post-item">
            <span class="archive-post-date">Invalid date</span><a class="archive-post-title" href= "/2018/08/09/日志管理介绍/" >[Untitled Post]</a>
        </li>
    
    </div>
  </div>
        <div class="sidebar-panel-tags">
    <div class="sidebar-tags-name">
    
        <span class="sidebar-tag-name" data-tags="Linux"><span class="iconfont-archer">&#xe606;</span>Linux</span>
    
        <span class="sidebar-tag-name" data-tags="DHCP"><span class="iconfont-archer">&#xe606;</span>DHCP</span>
    
        <span class="sidebar-tag-name" data-tags="haproxy"><span class="iconfont-archer">&#xe606;</span>haproxy</span>
    
        <span class="sidebar-tag-name" data-tags="LAMP"><span class="iconfont-archer">&#xe606;</span>LAMP</span>
    
        <span class="sidebar-tag-name" data-tags="DNS"><span class="iconfont-archer">&#xe606;</span>DNS</span>
    
        <span class="sidebar-tag-name" data-tags="权限管理"><span class="iconfont-archer">&#xe606;</span>权限管理</span>
    
        <span class="sidebar-tag-name" data-tags="用户组"><span class="iconfont-archer">&#xe606;</span>用户组</span>
    
        <span class="sidebar-tag-name" data-tags="练习题"><span class="iconfont-archer">&#xe606;</span>练习题</span>
    
        <span class="sidebar-tag-name" data-tags="文件系统"><span class="iconfont-archer">&#xe606;</span>文件系统</span>
    
        <span class="sidebar-tag-name" data-tags="MYSQL"><span class="iconfont-archer">&#xe606;</span>MYSQL</span>
    
        <span class="sidebar-tag-name" data-tags="su和sudo"><span class="iconfont-archer">&#xe606;</span>su和sudo</span>
    
        <span class="sidebar-tag-name" data-tags="SSH"><span class="iconfont-archer">&#xe606;</span>SSH</span>
    
        <span class="sidebar-tag-name" data-tags="varnish"><span class="iconfont-archer">&#xe606;</span>varnish</span>
    
        <span class="sidebar-tag-name" data-tags="TCP/IP"><span class="iconfont-archer">&#xe606;</span>TCP/IP</span>
    
        <span class="sidebar-tag-name" data-tags="keepalied"><span class="iconfont-archer">&#xe606;</span>keepalied</span>
    
        <span class="sidebar-tag-name" data-tags="lvs"><span class="iconfont-archer">&#xe606;</span>lvs</span>
    
        <span class="sidebar-tag-name" data-tags="memcache"><span class="iconfont-archer">&#xe606;</span>memcache</span>
    
        <span class="sidebar-tag-name" data-tags="tomcat"><span class="iconfont-archer">&#xe606;</span>tomcat</span>
    
        <span class="sidebar-tag-name" data-tags="rpm"><span class="iconfont-archer">&#xe606;</span>rpm</span>
    
        <span class="sidebar-tag-name" data-tags="共享服务"><span class="iconfont-archer">&#xe606;</span>共享服务</span>
    
        <span class="sidebar-tag-name" data-tags="自动化安装"><span class="iconfont-archer">&#xe606;</span>自动化安装</span>
    
        <span class="sidebar-tag-name" data-tags="基本命令"><span class="iconfont-archer">&#xe606;</span>基本命令</span>
    
        <span class="sidebar-tag-name" data-tags="CA"><span class="iconfont-archer">&#xe606;</span>CA</span>
    
        <span class="sidebar-tag-name" data-tags="sed"><span class="iconfont-archer">&#xe606;</span>sed</span>
    
        <span class="sidebar-tag-name" data-tags="dns"><span class="iconfont-archer">&#xe606;</span>dns</span>
    
        <span class="sidebar-tag-name" data-tags="mini系统"><span class="iconfont-archer">&#xe606;</span>mini系统</span>
    
        <span class="sidebar-tag-name" data-tags="进程管理、计划任务"><span class="iconfont-archer">&#xe606;</span>进程管理、计划任务</span>
    
    </div>
    <div class="iconfont-archer sidebar-tags-empty">&#xe678;</div>
    <div class="tag-load-fail" style="display: none; color: #ccc; font-size: 0.6rem;">
    缺失模块。<br/>
    1、请确保node版本大于6.2<br/>
    2、在博客根目录（注意不是archer根目录）执行以下命令：<br/>
    <span style="color: #f75357; font-size: 1rem; line-height: 2rem;">npm i hexo-generator-json-content --save</span><br/>
    3、在根目录_config.yml里添加配置：
    <pre style="color: #787878; font-size: 0.6rem;">
jsonContent:
  meta: false
  pages: false
  posts:
    title: true
    date: true
    path: true
    text: false
    raw: false
    content: false
    slug: false
    updated: false
    comments: false
    link: false
    permalink: false
    excerpt: false
    categories: true
    tags: true</pre>
    </div> 
    <div class="sidebar-tags-list"></div>
</div>
        <div class="sidebar-panel-categories">
    <div class="sidebar-categories-name">
    
    </div>
    <div class="iconfont-archer sidebar-categories-empty">&#xe678;</div>
    <div class="sidebar-categories-list"></div>
</div>
    </div>
</div> 
    <script>
    var siteMeta = {
        root: "/",
        author: "John Doe"
    }
</script>
    <!-- CDN failover -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
    <script type="text/javascript">
        if (typeof window.$ === 'undefined')
        {
            console.warn('jquery load from jsdelivr failed, will load local script')
            document.write('<script src="/lib/jquery.min.js">\x3C/script>')
        }
    </script>
    <script src="/scripts/main.js"></script>
    <!-- algolia -->
    
    <!-- busuanzi  -->
    
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    
    <!-- CNZZ  -->
    
    </div>
    <!-- async load share.js -->
    
        <script src="/scripts/share.js" async></script>    
     
    </body>
</html>


